<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/WangZhi.github.io/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/WangZhi.github.io/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/WangZhi.github.io/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/WangZhi.github.io/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/WangZhi.github.io/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/WangZhi.github.io/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/WangZhi.github.io/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta property="og:type" content="website">
<meta property="og:title" content="IT小白进阶">
<meta property="og:url" content="https://misswanglove.github.io/WangZhi.github.io/index.html">
<meta property="og:site_name" content="IT小白进阶">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="IT小白进阶">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/WangZhi.github.io/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"right","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://misswanglove.github.io/WangZhi.github.io/"/>





  <title>IT小白进阶</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-right 
  page-home">
    <div class="headband"></div>
	<a href="https://github.com/MissWangLove"><img style="position: absolute; top: 0; left: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_left_red_aa0000.png" alt="Fork me on GitHub"></a>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/WangZhi.github.io/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">IT小白进阶</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/WangZhi.github.io/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-question-circle"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/WangZhi.github.io/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-question-circle"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/WangZhi.github.io/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-question-circle"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/WangZhi.github.io/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-question-circle"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/WangZhi.github.io/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-question-circle"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-search">
          <a href="/WangZhi.github.io/search" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-question-circle"></i> <br />
            
            搜索
          </a>
        </li>
      
        
        <li class="menu-item menu-item-commonweal">
          <a href="/WangZhi.github.io/404.html" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-question-circle"></i> <br />
            
            公益404
          </a>
        </li>
      
        
        <li class="menu-item menu-item-something">
          <a href="/WangZhi.github.io/something" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-question-circle"></i> <br />
            
            something
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://misswanglove.github.io/WangZhi.github.io/WangZhi.github.io/2018/08/09/mysql/day05-连接池/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="王智家园">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/WangZhi.github.io/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="IT小白进阶">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/WangZhi.github.io/2018/08/09/mysql/day05-连接池/" itemprop="url">day05 连接池</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-08-09T18:06:18+08:00">
                2018-08-09
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/WangZhi.github.io/categories/Mysql/" itemprop="url" rel="index">
                    <span itemprop="name">Mysql</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="数据库连接池"><a href="#数据库连接池" class="headerlink" title="数据库连接池"></a>数据库连接池</h2><h4 id="连接池的概述"><a href="#连接池的概述" class="headerlink" title="连接池的概述"></a>连接池的概述</h4><ol>
<li><p>概念：其实就是一个容器(集合)，存放数据库连接的容器。<br>当系统初始化好后，容器被创建，容器中会申请一些连接对象，当用户来访问数据库时，<br>从容器中获取连接对象，用户访问完之后，会将连接对象归还给容器。</p>
</li>
<li><p>好处：</p>
<ul>
<li>节约资源<ul>
<li>用户访问高效</li>
</ul>
</li>
</ul>
</li>
<li><p>实现：</p>
<ol>
<li>标准接口：DataSource   javax.sql包下的<ol>
<li>方法：<ul>
<li>获取连接：getConnection()<ul>
<li>归还连接：Connection.close()。如果连接对象Connection是从连接池中获取的，那么调用Connection.close()方法，<br>则不会再关闭连接了。而是归还连接</li>
</ul>
</li>
</ul>
</li>
<li>一般我们不去实现它，有数据库厂商来实现<ol>
<li>C3P0：数据库连接池技术</li>
<li>Druid：数据库连接池实现技术，由阿里巴巴提供的</li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
<li><p>C3P0：数据库连接池技术</p>
<ul>
<li>步骤：<ol>
<li>导入jar包 (两个) c3p0-0.9.5.2.jar mchange-commons-java-0.2.12.jar ，<ul>
<li>不要忘记导入数据库驱动jar包</li>
</ul>
</li>
<li>定义配置文件：<ul>
<li>名称： c3p0.properties 或者 c3p0-config.xml</li>
<li>路径：直接将文件放在src目录下即可。</li>
</ul>
</li>
<li>创建核心对象 数据库连接池对象 ComboPooledDataSource</li>
<li>获取连接： getConnection</li>
</ol>
</li>
<li>代码：<br>//1.创建数据库连接池对象<br>  DataSource ds  = new ComboPooledDataSource();<br>  //2. 获取连接对象<br>  Connection conn = ds.getConnection();</li>
</ul>
</li>
<li><p>Druid:数据库连接池实现技术，由阿里巴巴提供</p>
<ol>
<li>步骤：<ol>
<li>导入jar包 druid-1.0.9.jar</li>
<li>定义配置文件：<ul>
<li>是properties形式的</li>
<li>可以叫任意名称，可以放在任意目录下</li>
</ul>
</li>
<li>加载配置文件。Properties</li>
<li>获取数据库连接池对象：通过工厂来来获取  DruidDataSourceFactory</li>
<li>获取连接：getConnection</li>
</ol>
</li>
</ol>
<ul>
<li>代码：<br>//3.加载配置文件</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Properties pro = new Properties();</span><br><span class="line">InputStream is = DruidDemo.class.getClassLoader().getResourceAsStream(&quot;druid.properties&quot;);</span><br><span class="line">pro.load(is);</span><br><span class="line">//4.获取连接池对象</span><br><span class="line">DataSource ds = DruidDataSourceFactory.createDataSource(pro);</span><br><span class="line">//5.获取连接</span><br><span class="line">Connection conn = ds.getConnection();</span><br></pre></td></tr></table></figure>
<ol>
<li><p>定义工具类</p>
<ol>
<li>定义一个类 JDBCUtils</li>
<li>提供静态代码块加载配置文件，初始化连接池对象</li>
<li>提供方法<ol>
<li>获取连接方法：通过数据库连接池获取连接</li>
<li>释放资源</li>
<li>获取连接池的方法</li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">driverClassName=com.mysql.jdbc.Driver</span><br><span class="line">url=jdbc:mysql:<span class="comment">//127.0.0.1:3306/db3?useSSL=true</span></span><br><span class="line">username=root</span><br><span class="line">password=root</span><br><span class="line">initialSize=<span class="number">5</span></span><br><span class="line">maxActive=<span class="number">10</span></span><br><span class="line">maxWait=<span class="number">3000</span></span><br></pre></td></tr></table></figure>
<p>​<br>        public class JDBCUtils {</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line">    /**</span><br><span class="line">     * 定义数据源</span><br><span class="line">     */</span><br><span class="line">    private static DataSource ds;</span><br><span class="line"></span><br><span class="line">    static &#123;</span><br><span class="line">        try &#123;</span><br><span class="line">            /**</span><br><span class="line">             * 加载配置文件</span><br><span class="line">             */</span><br><span class="line">            InputStream is = JDBCUtils.class.getClassLoader().getResourceAsStream(&quot;druid.properties&quot;);</span><br><span class="line">            Properties pro = new Properties();</span><br><span class="line">            pro.load(is);</span><br><span class="line">            /**</span><br><span class="line">             * 获取数据源</span><br><span class="line">             */</span><br><span class="line">            ds = DruidDataSourceFactory.createDataSource(pro);</span><br><span class="line"></span><br><span class="line">        &#125; catch (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; catch (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 获取数据源</span><br><span class="line">     * @return 返回数据源</span><br><span class="line">     */</span><br><span class="line">    public static DataSource getDataSource()&#123;</span><br><span class="line">        return ds;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 获取连接对象</span><br><span class="line">     * @return 返回连接对象</span><br><span class="line">     * @throws SQLException  抛出的编译异常</span><br><span class="line">     */</span><br><span class="line">    public static Connection getConn() throws SQLException &#123;</span><br><span class="line">        return ds.getConnection();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     *  关闭连接</span><br><span class="line">     * @param stmt  sql执行对象</span><br><span class="line">     * @param conn  数据库连接对象</span><br><span class="line">     */</span><br><span class="line">    public static void close(Statement stmt, Connection conn)&#123;</span><br><span class="line">        if(stmt != null)&#123;</span><br><span class="line">            try &#123;</span><br><span class="line">                stmt.close();</span><br><span class="line">            &#125; catch (SQLException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        if(conn != null)&#123;</span><br><span class="line">            try &#123;</span><br><span class="line">                conn.close();</span><br><span class="line">            &#125; catch (SQLException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 关闭资源的重载方法</span><br><span class="line">     * @param rs    处理结果集的对象</span><br><span class="line">     * @param stmt  执行sql语句的对象</span><br><span class="line">     * @param conn  连接数据库的对象</span><br><span class="line">     */</span><br><span class="line">    public static void close(ResultSet rs, Statement stmt, Connection conn)&#123;</span><br><span class="line"></span><br><span class="line">        if(rs != null)&#123;</span><br><span class="line">            try &#123;</span><br><span class="line">                rs.close();</span><br><span class="line">            &#125; catch (SQLException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        if(stmt != null)&#123;</span><br><span class="line">            try &#123;</span><br><span class="line">                stmt.close();</span><br><span class="line">            &#125; catch (SQLException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        if(conn != null)&#123;</span><br><span class="line">            try &#123;</span><br><span class="line">                conn.close();</span><br><span class="line">            &#125; catch (SQLException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="JdbcTemplate"><a href="#JdbcTemplate" class="headerlink" title="JdbcTemplate"></a>JdbcTemplate</h4><ul>
<li><p>Spring框架对JDBC的简单封装。提供了一个JDBCTemplate对象简化JDBC的开发</p>
</li>
<li><p>步骤：</p>
<ol>
<li>导入jar包</li>
<li>创建JdbcTemplate对象。依赖于数据源DataSource</li>
</ol>
<ul>
<li>JdbcTemplate template = new JdbcTemplate(ds);</li>
</ul>
<ol>
<li>调用JdbcTemplate的方法来完成CRUD的操作</li>
</ol>
<ul>
<li>update():执行DML语句。增、删、改语句</li>
<li>queryForMap():查询结果将结果集封装为map集合，将列名作为key，将值作为value 将这条记录封装为一个map集合<ul>
<li>注意：这个方法查询的结果集长度只能是1</li>
</ul>
</li>
<li>queryForList():查询结果将结果集封装为list集合<ul>
<li>注意：将每一条记录封装为一个Map集合，再将Map集合装载到List集合中</li>
</ul>
</li>
<li>query():查询结果，将结果封装为JavaBean对象<ul>
<li>query的参数：RowMapper<ul>
<li>一般我们使用BeanPropertyRowMapper实现类。可以完成数据到JavaBean的自动封装</li>
<li>new BeanPropertyRowMapper&lt;类型&gt;(类型.class)</li>
</ul>
</li>
</ul>
</li>
<li>queryForObject：查询结果，将结果封装为对象<ul>
<li>一般用于聚合函数的查询</li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SpringJdbcTemplateTest</span> </span>&#123;</span><br><span class="line">   <span class="keyword">private</span> <span class="keyword">static</span> JdbcTemplate jdbcTemplate;</span><br><span class="line">   </span><br><span class="line">   <span class="meta">@Before</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">       <span class="comment">// 1. 导入jar包</span></span><br><span class="line">       <span class="comment">// 2. 创建JDBCTemplate对象</span></span><br><span class="line">       jdbcTemplate = <span class="keyword">new</span> JdbcTemplate(JdbcUtils.getDataSource());</span><br><span class="line">   &#125;</span><br><span class="line">   </span><br><span class="line">   <span class="meta">@Test</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testInsert</span><span class="params">()</span></span>&#123;</span><br><span class="line">       <span class="comment">// 创建sql</span></span><br><span class="line">       String sql = <span class="string">"INSERT INTO ACCOUNT VALUES(NULL,?,?)"</span>;</span><br><span class="line">       <span class="comment">// 执行sql,返回影响的行数</span></span><br><span class="line">       <span class="keyword">int</span> lines = jdbcTemplate.update(sql, <span class="string">"王五"</span>, <span class="number">5000</span>);</span><br><span class="line">       System.out.println(<span class="string">"影响的行数为："</span> + lines);</span><br><span class="line">   &#125;</span><br><span class="line">   </span><br><span class="line">   <span class="meta">@Test</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testUpdate</span><span class="params">()</span></span>&#123;</span><br><span class="line">       <span class="comment">// 创建sql</span></span><br><span class="line">       String sql = <span class="string">"UPDATE ACCOUNT SET BALANCE = ? WHERE ID = ?"</span>;</span><br><span class="line">       <span class="comment">// 执行sql,返回影响的行数</span></span><br><span class="line">       <span class="keyword">int</span> lines = jdbcTemplate.update(sql, <span class="number">3000</span>, <span class="number">3</span>);</span><br><span class="line">       System.out.println(<span class="string">"影响的行数为："</span> + lines);</span><br><span class="line">   &#125;</span><br><span class="line">   </span><br><span class="line">   <span class="meta">@Test</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testDelete</span><span class="params">()</span></span>&#123;</span><br><span class="line">       <span class="comment">// 创建sql</span></span><br><span class="line">       String sql = <span class="string">"DELETE FROM ACCOUNT WHERE ID = ?"</span>;</span><br><span class="line">       <span class="comment">// 执行sql,返回影响的行数</span></span><br><span class="line">       <span class="keyword">int</span> lines = jdbcTemplate.update(sql, <span class="number">3</span>);</span><br><span class="line">       System.out.println(<span class="string">"影响的行数为："</span> + lines);</span><br><span class="line">   &#125;</span><br><span class="line">   </span><br><span class="line">   <span class="meta">@Test</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testQueryForMap</span><span class="params">()</span></span>&#123;</span><br><span class="line">       <span class="comment">// 3. 创建sql</span></span><br><span class="line">       String sql = <span class="string">"SELECT * FROM STUDENT WHERE ID = ?"</span>;</span><br><span class="line">       <span class="comment">// 4. 使用查询语句进行查询(变长参数替换占位符)</span></span><br><span class="line">       Map&lt;String, Object&gt; map = jdbcTemplate.queryForMap(sql,<span class="number">7</span>);</span><br><span class="line">       System.out.println(map);</span><br><span class="line">   &#125;</span><br><span class="line">   </span><br><span class="line">   <span class="meta">@Test</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testQueryForList</span><span class="params">()</span></span>&#123;</span><br><span class="line">       <span class="comment">// 创建sql语句</span></span><br><span class="line">       String sql = <span class="string">"SELECT * FROM STUDENT"</span>;</span><br><span class="line">       <span class="comment">// 执行sql，返回结果</span></span><br><span class="line">       List&lt;Map&lt;String, Object&gt;&gt; list = jdbcTemplate.queryForList(sql);</span><br><span class="line">       <span class="comment">// 处理结果</span></span><br><span class="line">       <span class="keyword">for</span> (Map&lt;String, Object&gt; map : list) &#123;</span><br><span class="line">           System.out.println(map);</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br><span class="line">   </span><br><span class="line">   <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * queryForMap:将结果封装成Map，只能返回一条结果，</span></span><br><span class="line"><span class="comment">    * 列名为Key，对应的值为Value</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   <span class="meta">@Test</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testQuery</span><span class="params">()</span></span>&#123;</span><br><span class="line">       <span class="comment">// 创建sql</span></span><br><span class="line">       String sql = <span class="string">"SELECT * FROM ACCOUNT"</span>;</span><br><span class="line">       <span class="comment">// 执行sql(使用BeanPropertyRowMapper实现类。可以完成数据到JavaBean的自动封装)</span></span><br><span class="line">       List&lt;Account&gt; accounts = jdbcTemplate.query(sql, <span class="keyword">new</span> BeanPropertyRowMapper&lt;&gt;(Account.class));</span><br><span class="line">       <span class="comment">// 处理结果</span></span><br><span class="line">       <span class="keyword">for</span> (Account account : accounts) &#123;</span><br><span class="line">           System.out.println(account);</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br><span class="line">   </span><br><span class="line">   <span class="meta">@Test</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testQueryForObject</span><span class="params">()</span></span>&#123;</span><br><span class="line">       <span class="comment">// 创建sql</span></span><br><span class="line">       String sql = <span class="string">"SELECT COUNT(ID) FROM ACCOUNT"</span>;</span><br><span class="line">       <span class="comment">// 执行sql,一般用于查询聚合函数（）</span></span><br><span class="line">       Long count = jdbcTemplate.queryForObject(sql,Long.class);</span><br><span class="line">       System.out.println();</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://misswanglove.github.io/WangZhi.github.io/WangZhi.github.io/2018/08/09/mysql/day04-JDBC概述/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="王智家园">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/WangZhi.github.io/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="IT小白进阶">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/WangZhi.github.io/2018/08/09/mysql/day04-JDBC概述/" itemprop="url">day04 JDBC概述</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-08-09T17:51:46+08:00">
                2018-08-09
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/WangZhi.github.io/categories/Mysql/" itemprop="url" rel="index">
                    <span itemprop="name">Mysql</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="JDBC的简单介绍"><a href="#JDBC的简单介绍" class="headerlink" title="JDBC的简单介绍"></a>JDBC的简单介绍</h2><h4 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h4><ul>
<li>JDBC ： Java Database Connectivity，java连接数据库，使用Java操作数据库的技术。</li>
<li>本质 ： 其实就是sun公司定义的一套操作所有关系型数据库的规则，即接口。<br>各个数据库厂商去实现这套接口，提供数据库操作<strong>驱动jar包</strong>，我们可以使用这套<br>接口进行（JDBC）编程，真正执行的代码是驱动jar包的实现类。</li>
</ul>
<h4 id="快速入门"><a href="#快速入门" class="headerlink" title="快速入门"></a>快速入门</h4><p>本人使用的是jdk10和mysql-connector-java-5.1.45-bin.jar。  </p>
<p>步骤：</p>
<ol>
<li><p>导入驱动jar包</p>
<ul>
<li>项目根目录创建文件夹libs。</li>
<li>将mysql-connector-java-5.1.45-bin.jar复制到libs目录下</li>
<li>右击libs下，Add as Library将jar包导入项目中</li>
</ul>
</li>
<li><p>注册驱动</p>
</li>
<li><p>获取数据库连接对象（Collection）</p>
</li>
<li><p>定义sql</p>
</li>
<li><p>获取执行sql语句的对象 Statement</p>
</li>
<li><p>执行sql，接受返回结果（ResultSet）</p>
</li>
<li><p>处理结果</p>
</li>
<li><p>释放资源</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">// 2. 注册驱动</span><br><span class="line">Class.forName(&quot;com.mysql.jdbc.Driver&quot;);</span><br><span class="line">// 3. 获取连接对象Collection</span><br><span class="line">Connection conn = DriverManager.getConnection(&quot;jdbc:mysql://localhost:3306/db1&quot;, &quot;root&quot;, &quot;nrblwbb7&quot;);</span><br><span class="line">// 4. 定义sql</span><br><span class="line">String sql = &quot;UPDATE STUDENT SET AGE = 23 WHERE NAME = &apos;王智&apos;&quot;;</span><br><span class="line">// 5. 获取执行sql语句的对象 Statement</span><br><span class="line">Statement statement = conn.createStatement();</span><br><span class="line">// 6. 执行sql，接受返回结果（ResultSet）</span><br><span class="line">int result = statement.executeUpdate(sql);</span><br><span class="line">// 7. 处理结果</span><br><span class="line">System.out.println(result);</span><br><span class="line">// 8. 释放资源</span><br><span class="line">statement.close();</span><br><span class="line">conn.close();</span><br></pre></td></tr></table></figure>
<p>​    </p>
</li>
</ol>
<h4 id="详解各个对象"><a href="#详解各个对象" class="headerlink" title="详解各个对象"></a>详解各个对象</h4><ol>
<li>DriverManager：驱动管理对象</li>
<li>Connection：数据库连接对象</li>
<li>Statement：执行sql对象</li>
<li>ResultSet：结果集对象</li>
<li>PreparedStatement ：执行sql对象</li>
</ol>
<h6 id="DriverManager"><a href="#DriverManager" class="headerlink" title="DriverManager"></a>DriverManager</h6><p>功能：</p>
<ol>
<li><p>注册驱动：告诉程序该使用哪一个数据库驱动jar</p>
<ul>
<li><p>使用的方法：static void registerDriver(Driver driver) :注册与给定的驱动程序 DriverManager 。 </p>
</li>
<li><p>写代码使用：Class.forName(“com.mysql.jdbc.Driver”);</p>
</li>
<li><p>通过查看源码发现：在com.mysql.jdbc.Driver类中存在静态代码块</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">static &#123;</span><br><span class="line">       try &#123;</span><br><span class="line">           java.sql.DriverManager.registerDriver(new Driver());</span><br><span class="line">       &#125; catch (SQLException E) &#123;</span><br><span class="line">           throw new RuntimeException(&quot;Can&apos;t register driver!&quot;);</span><br><span class="line">       &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<blockquote>
<p>注意：mysql5之后的驱动jar包可以省略注册驱动的步骤。   </p>
</blockquote>
</li>
<li><p>获取数据库连接</p>
<ul>
<li>方法：static Connection getConnection(String url, String user, String password) </li>
<li>参数：<ul>
<li>url：指定连接的路径<ul>
<li>语法：jdbc:mysql://ip地址(域名):端口号/数据库名称</li>
<li>例子：jdbc:mysql://localhost:3306/db</li>
<li>细节：如果连接的是本机mysql服务器，并且mysql服务默认端口是3306，则url可以简写为：jdbc:mysql:///数据库名称</li>
<li>jdbc是连接数据库的协议，mysql是连接mysql数据库的子协议</li>
</ul>
</li>
<li>user：用户名</li>
<li>password：密码 </li>
</ul>
</li>
</ul>
</li>
</ol>
<h6 id="Collection连接对象"><a href="#Collection连接对象" class="headerlink" title="Collection连接对象"></a>Collection连接对象</h6><p>功能：</p>
<ol>
<li>获取执行sql的对象<ul>
<li>Statement createStatement()</li>
<li>PreparedStatement prepareStatement(String sql) </li>
</ul>
</li>
<li>管理事务<ul>
<li>开启事务：setAutoCommit(boolean autoCommit) ：调用该方法设置参数为false，即开启事务</li>
<li>提交事务：commit() </li>
<li>回滚事务：rollback()</li>
</ul>
</li>
</ol>
<h6 id="Statement执行静态sql对象"><a href="#Statement执行静态sql对象" class="headerlink" title="Statement执行静态sql对象"></a>Statement执行静态sql对象</h6><p>功能：</p>
<ol>
<li>执行sql<ul>
<li>boolean execute(String sql) ：可以执行任意的sql （了解） </li>
<li>int executeUpdate(String sql) ：执行DML（insert、update、delete）语句、DDL(create，alter、drop)语句<ul>
<li>返回值：影响的行数，可以通过这个影响的行数判断DML语句是否执行成功 返回值&gt;0的则执行成功，反之，则失败。</li>
</ul>
</li>
<li>ResultSet executeQuery(String sql)  ：执行DQL（select)语句</li>
</ul>
</li>
</ol>
<p>插入举例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">public static void main(String[] args) &#123;</span><br><span class="line">       Connection conn = null;</span><br><span class="line">       Statement stmt = null;</span><br><span class="line">       try &#123;</span><br><span class="line">           // 1. 加载驱动</span><br><span class="line">           Class.forName(&quot;com.mysql.jdbc.Driver&quot;);</span><br><span class="line">           // 2. 获取连接对象</span><br><span class="line">           conn = DriverManager.getConnection(&quot;jdbc:mysql://localhost:3306/db3?useSSL=true&quot;, &quot;root&quot;, &quot;nrblwbb7&quot;);</span><br><span class="line">           // 3. 创建sql</span><br><span class="line">           String sql = &quot;INSERT INTO ACCOUNT VALUES (NULL,&apos;网址&apos;,2000)&quot;;</span><br><span class="line">           // 4. 获取执行sql对象</span><br><span class="line">           stmt = conn.createStatement();</span><br><span class="line">           // 5. 执行sql</span><br><span class="line">           int count = stmt.executeUpdate(sql);</span><br><span class="line">           // 6. 处理结果</span><br><span class="line">           System.out.println(&quot;影响的行数为：&quot; + count);</span><br><span class="line">           if(count &gt; 0)&#123;</span><br><span class="line">               System.out.println(&quot;插入成功&quot;);</span><br><span class="line">           &#125;else&#123;</span><br><span class="line">               System.out.println(&quot;操作失败&quot;);</span><br><span class="line">           &#125;</span><br><span class="line">       &#125; catch (ClassNotFoundException e) &#123;</span><br><span class="line">           e.printStackTrace();</span><br><span class="line">       &#125; catch (SQLException e) &#123;</span><br><span class="line">           e.printStackTrace();</span><br><span class="line">       &#125; finally &#123;</span><br><span class="line">           // 7. 释放资源</span><br><span class="line">           if(stmt != null)&#123;</span><br><span class="line">               try &#123;</span><br><span class="line">                   stmt.close();</span><br><span class="line">               &#125; catch (SQLException e) &#123;</span><br><span class="line">                   e.printStackTrace();</span><br><span class="line">               &#125;</span><br><span class="line">           &#125;</span><br><span class="line">           if(conn != null)&#123;</span><br><span class="line">               try &#123;</span><br><span class="line">                   conn.close();</span><br><span class="line">               &#125; catch (SQLException e) &#123;</span><br><span class="line">                   e.printStackTrace();</span><br><span class="line">               &#125;</span><br><span class="line">           &#125;</span><br><span class="line"></span><br><span class="line">       &#125;</span><br><span class="line"> ｝</span><br></pre></td></tr></table></figure>
<p> 修改举例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">public static void main(String[] args) &#123;</span><br><span class="line">       /**</span><br><span class="line">        * 由于Connection和Statement实现了AutoCloseable接口，所以可以使用自动关闭</span><br><span class="line">        */</span><br><span class="line">       try(</span><br><span class="line">               // 2.获取Connection对象</span><br><span class="line">               Connection conn = DriverManager.getConnection(</span><br><span class="line">                       &quot;jdbc:mysql://localhost:3306/db3?useSSL=true&quot;,</span><br><span class="line">                       &quot;root&quot;,</span><br><span class="line">                       &quot;nrblwbb7&quot;) ;</span><br><span class="line">               // 3. 获取Statement对象</span><br><span class="line">               Statement stmt = conn.createStatement()</span><br><span class="line">               )&#123;</span><br><span class="line">           // 1.加载驱动</span><br><span class="line">           Class.forName(&quot;com.mysql.jdbc.Driver&quot;);</span><br><span class="line">           // 4. 创建sql</span><br><span class="line">           String sql = &quot;UPDATE ACCOUNT SET BALANCE = 1500 WHERE NAME = &apos;网址&apos;&quot;;</span><br><span class="line">           // 5. 执行sql</span><br><span class="line">           int count = stmt.executeUpdate(sql);</span><br><span class="line">           // 6. 处理结果</span><br><span class="line">           System.out.println(count);</span><br><span class="line">           if(count &gt; 0)&#123;</span><br><span class="line">               System.out.println(&quot;修改成功&quot;);</span><br><span class="line">           &#125;else&#123;</span><br><span class="line">               System.out.println(&quot;操作失败或者记录未更改&quot;);</span><br><span class="line">           &#125;</span><br><span class="line">           // 7. 关闭连接，由于try..with..resource会自动关闭，所以无须担心</span><br><span class="line">       &#125; catch (SQLException e) &#123;</span><br><span class="line">           e.printStackTrace();</span><br><span class="line">       &#125; catch (ClassNotFoundException e) &#123;</span><br><span class="line">           e.printStackTrace();</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<p> 删除举例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">public static void main(String[] args) &#123;</span><br><span class="line">       /**</span><br><span class="line">        * 由于Connection和Statement实现了AutoCloseable接口，所以可以使用自动关闭</span><br><span class="line">        */</span><br><span class="line">       try(</span><br><span class="line">               // 2.获取Connection对象</span><br><span class="line">               Connection conn = DriverManager.getConnection(</span><br><span class="line">                       &quot;jdbc:mysql://localhost:3306/db3?useSSL=true&quot;,</span><br><span class="line">                       &quot;root&quot;,</span><br><span class="line">                       &quot;nrblwbb7&quot;) ;</span><br><span class="line">               // 3. 获取Statement对象</span><br><span class="line">               Statement stmt = conn.createStatement()</span><br><span class="line">               )&#123;</span><br><span class="line">           // 1.加载驱动</span><br><span class="line">           Class.forName(&quot;com.mysql.jdbc.Driver&quot;);</span><br><span class="line">           // 4. 创建sql</span><br><span class="line">           String sql = &quot;DELETE FROM ACCOUNT WHERE NAME = &apos;网址&apos;&quot;;</span><br><span class="line">           // 5. 执行sql</span><br><span class="line">           int count = stmt.executeUpdate(sql);</span><br><span class="line">           // 6. 处理结果</span><br><span class="line">           System.out.println(count);</span><br><span class="line">           if(count &gt; 0)&#123;</span><br><span class="line">               System.out.println(&quot;删除成功&quot;);</span><br><span class="line">           &#125;else&#123;</span><br><span class="line">               System.out.println(&quot;删除失败&quot;);</span><br><span class="line">           &#125;</span><br><span class="line">           // 7. 关闭连接，由于try..with..resource会自动关闭，所以无须担心</span><br><span class="line">       &#125; catch (SQLException e) &#123;</span><br><span class="line">           e.printStackTrace();</span><br><span class="line">       &#125; catch (ClassNotFoundException e) &#123;</span><br><span class="line">           e.printStackTrace();</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<h6 id="ResultSet-结果及对象，封装查询结果"><a href="#ResultSet-结果及对象，封装查询结果" class="headerlink" title="ResultSet:结果及对象，封装查询结果"></a>ResultSet:结果及对象，封装查询结果</h6><p>功能：</p>
<ol>
<li>封装查询结果：<ul>
<li>boolean next(): 游标向下移动一行，判断当前行是否是最后一行末尾(是否有数据)，如果是，则返回false，如果不是则返回true</li>
<li>getXxx(参数):获取数据<ul>
<li>Xxx：代表数据类型   如： int getInt() ,    String getString()</li>
<li>参数：<ol>
<li>int：代表列的编号,从1开始   如： getString(1)</li>
<li>String：代表列名称。 如： getDouble(“balance”)</li>
</ol>
</li>
</ul>
</li>
<li>注意：<ul>
<li>使用步骤：<ol>
<li>游标向下移动一行</li>
<li>判断是否有数据</li>
<li>获取数据</li>
</ol>
</li>
</ul>
</li>
</ul>
</li>
</ol>
<p>举个简单例子：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">@Test</span><br><span class="line">   public void selectDemo()&#123;</span><br><span class="line">       try &#123;</span><br><span class="line">           // 1.加载驱动</span><br><span class="line">           Class.forName(&quot;com.mysql.jdbc.Driver&quot;);</span><br><span class="line">           // 2.创建sql语句</span><br><span class="line">           String sql = &quot;select * from account&quot;;</span><br><span class="line">           try(</span><br><span class="line">                   // 3.获取连接对象</span><br><span class="line">                   Connection conn = DriverManager.getConnection(</span><br><span class="line">                           &quot;jdbc:mysql://localhost:3306/db3?useSSL=true&quot;,</span><br><span class="line">                           &quot;root&quot;,</span><br><span class="line">                           &quot;root&quot;);</span><br><span class="line">                   // 4.获取执行sql语句对象</span><br><span class="line">                   Statement stmt = conn.createStatement()</span><br><span class="line">           )&#123;</span><br><span class="line">               // 5.执行sql</span><br><span class="line">               ResultSet rs = stmt.executeQuery(sql);</span><br><span class="line">               // 6.处理结果集</span><br><span class="line">               while(rs.next())&#123;</span><br><span class="line">                   // 获取id</span><br><span class="line">                   int id = rs.getInt(&quot;id&quot;);</span><br><span class="line">                   // 获取姓名</span><br><span class="line">                   String name = rs.getString(&quot;name&quot;);</span><br><span class="line">                   // 获取账户余额</span><br><span class="line">                   double balance = rs.getDouble(&quot;balance&quot;);</span><br><span class="line">                   // 正确的处理应该是封装为对象，进行处理，这就简单展示下</span><br><span class="line">                   System.out.println(&quot;id = &quot; + id + &quot;, name = &quot; + name + &quot;, balance = &quot; + balance);</span><br><span class="line">               &#125;</span><br><span class="line"></span><br><span class="line">           &#125; catch (SQLException e) &#123;</span><br><span class="line">               e.printStackTrace();</span><br><span class="line">           &#125;</span><br><span class="line">       &#125; catch (ClassNotFoundException e) &#123;</span><br><span class="line">           e.printStackTrace();</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<h6 id="PreparedStatement：执行动态sql的对象"><a href="#PreparedStatement：执行动态sql的对象" class="headerlink" title="PreparedStatement：执行动态sql的对象"></a>PreparedStatement：执行动态sql的对象</h6><p>功能：</p>
<ol>
<li><p>执行动态的sql</p>
<ol>
<li><p>SQL注入问题：在拼接sql时，有一些sql的特殊关键字参与字符串的拼接。会造成安全性问题</p>
<ol>
<li>输入用户随便，输入密码：a’ or ‘a’ = ‘a</li>
<li>sql：select * from user where username = ‘fhdsjkf’ and password = ‘a’ or ‘a’ = ‘a’ </li>
</ol>
</li>
<li><p>解决sql注入问题：使用PreparedStatement对象来解决</p>
</li>
<li><p>预编译的SQL：参数使用?作为占位符</p>
</li>
<li><p>步骤：</p>
<ol>
<li>导入驱动jar包 mysql-connector-java-5.1.45-bin.jar</li>
<li>注册驱动</li>
<li>获取数据库连接对象 Connection</li>
<li>定义sql<ul>
<li>注意：sql的参数使用？作为占位符。 如：select * from user where username = ? and password = ?;</li>
</ul>
</li>
<li>获取执行sql语句的对象 PreparedStatement  Connection.prepareStatement(String sql) </li>
<li>给？赋值：<ul>
<li>方法： setXxx(参数1,参数2)<ul>
<li>参数1：？的位置编号 从1 开始</li>
<li>参数2：？的值</li>
</ul>
</li>
</ul>
</li>
<li>执行sql，接受返回结果，不需要传递sql语句</li>
<li>处理结果</li>
<li>释放资源</li>
</ol>
</li>
<li><p>注意：后期都会使用PreparedStatement来完成增删改查的所有操作</p>
<ol>
<li>可以防止SQL注入</li>
<li>效率更高</li>
</ol>
</li>
</ol>
</li>
</ol>
<h4 id="封装工具类"><a href="#封装工具类" class="headerlink" title="封装工具类"></a>封装工具类</h4><p>src下db.properties的信息：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># 驱动</span><br><span class="line">driver=com.mysql.jdbc.Driver</span><br><span class="line"># url</span><br><span class="line">url=jdbc:mysql://127.0.0.1:3306/db3?useSSL=true</span><br><span class="line"># 用户</span><br><span class="line">username=root</span><br><span class="line"># 密码</span><br><span class="line">password=root</span><br></pre></td></tr></table></figure>
<p>封装的工具类如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line">public class JDBCUtils &#123;</span><br><span class="line"></span><br><span class="line">    private static String driver;</span><br><span class="line">    private static String url;</span><br><span class="line">    private static String username;</span><br><span class="line">    private static String password;</span><br><span class="line"></span><br><span class="line">    static&#123;</span><br><span class="line">        try &#123;</span><br><span class="line">            // 读取配置文件</span><br><span class="line">            InputStream inputStream = JDBCUtils.class.getClassLoader().getResourceAsStream(&quot;db.properties&quot;);</span><br><span class="line">            Properties pro = new Properties();</span><br><span class="line">            pro.load(inputStream);</span><br><span class="line">            // 静态变量赋值</span><br><span class="line">            driver = pro.getProperty(&quot;driver&quot;);</span><br><span class="line">            url = pro.getProperty(&quot;url&quot;);</span><br><span class="line">            username = pro.getProperty(&quot;username&quot;);</span><br><span class="line">            password = pro.getProperty(&quot;password&quot;);</span><br><span class="line">            // 注册驱动</span><br><span class="line">            Class.forName(driver);</span><br><span class="line">        &#125; catch (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; catch (ClassNotFoundException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 获取连接对象</span><br><span class="line">     * @return 返回连接对象</span><br><span class="line">     */</span><br><span class="line">    public static Connection getConn() throws SQLException &#123;</span><br><span class="line">        return DriverManager.getConnection(url,username,password);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 关闭资源</span><br><span class="line">     * @param stmt</span><br><span class="line">     * @param conn</span><br><span class="line">     */</span><br><span class="line">    public static void close(Statement stmt,Connection conn)&#123;</span><br><span class="line">        if(stmt != null)&#123;</span><br><span class="line">            try &#123;</span><br><span class="line">                stmt.close();</span><br><span class="line">            &#125; catch (SQLException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        if(conn != null)&#123;</span><br><span class="line">            try &#123;</span><br><span class="line">                conn.close();</span><br><span class="line">            &#125; catch (SQLException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 关闭资源</span><br><span class="line">     * @param rs</span><br><span class="line">     * @param stmt</span><br><span class="line">     * @param conn</span><br><span class="line">     */</span><br><span class="line">    public static void close(ResultSet rs, Statement stmt, Connection conn)&#123;</span><br><span class="line">        if(rs != null)&#123;</span><br><span class="line">            try &#123;</span><br><span class="line">                rs.close();</span><br><span class="line">            &#125; catch (SQLException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        if(stmt != null)&#123;</span><br><span class="line">            try &#123;</span><br><span class="line">                stmt.close();</span><br><span class="line">            &#125; catch (SQLException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        if(conn != null)&#123;</span><br><span class="line">            try &#123;</span><br><span class="line">                conn.close();</span><br><span class="line">            &#125; catch (SQLException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="事务管理"><a href="#事务管理" class="headerlink" title="事务管理"></a>事务管理</h4><ol>
<li><p>事务：一个包含多个步骤的业务操作。如果这个业务操作被事务管理，则这多个步骤要么同时成功，要么同时失败。</p>
</li>
<li><p>操作：</p>
<ol>
<li>开启事务</li>
<li>提交事务</li>
<li>回滚事务</li>
</ol>
</li>
<li><p>使用Connection对象来管理事务</p>
<ul>
<li><p>开启事务：setAutoCommit(boolean autoCommit) ：调用该方法设置参数为false，即开启事务</p>
<ul>
<li>在执行sql之前开启事务</li>
</ul>
</li>
<li><p>提交事务：commit() </p>
<ul>
<li>当所有sql都执行完提交事务</li>
</ul>
</li>
<li><p>回滚事务：rollback() </p>
<ul>
<li>在catch中回滚事务</li>
</ul>
</li>
</ul>
</li>
</ol>
<pre><code>测试：
</code></pre>   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">public static void main(String[] args) &#123;</span><br><span class="line">    Connection conn = null;</span><br><span class="line">    PreparedStatement pstmt1 = null;</span><br><span class="line">    PreparedStatement pstmt2 = null;</span><br><span class="line">    try &#123;</span><br><span class="line">        // 1.创建sql，转账的sql</span><br><span class="line">        String sql1 = &quot;UPDATE ACCOUNT SET BALANCE = BALANCE - ? WHERE ID = ?&quot;;</span><br><span class="line">        String sql2 = &quot;UPDATE ACCOUNT SET BALANCE = BALANCE + ? WHERE ID = ?&quot;;</span><br><span class="line">        // 2.获取连接对象</span><br><span class="line">        conn = JDBCUtils.getConn();</span><br><span class="line"></span><br><span class="line">        // 开启事务</span><br><span class="line">        conn.setAutoCommit(false);</span><br><span class="line"></span><br><span class="line">        // 3.获取执行sql对象，进行预编译</span><br><span class="line">        pstmt1 = conn.prepareStatement(sql1);</span><br><span class="line">        pstmt2 = conn.prepareStatement(sql2);</span><br><span class="line">        // 4.替换占位符</span><br><span class="line">        pstmt1.setDouble(1,500);</span><br><span class="line">        pstmt1.setInt(2,1);</span><br><span class="line">        pstmt2.setDouble(1,500);</span><br><span class="line">        pstmt2.setInt(2,2);</span><br><span class="line">        // 5.执行sql</span><br><span class="line">        pstmt1.executeUpdate();</span><br><span class="line">        // int i = 3 / 0;</span><br><span class="line">        pstmt2.executeUpdate();</span><br><span class="line"></span><br><span class="line">        // 提交事务</span><br><span class="line">        conn.commit();</span><br><span class="line">    &#125; catch (Exception e) &#123;</span><br><span class="line">        if(conn != null) &#123;</span><br><span class="line">            try &#123;</span><br><span class="line">                // 事务回滚</span><br><span class="line">                conn.rollback();</span><br><span class="line">            &#125; catch (SQLException e1) &#123;</span><br><span class="line">                e1.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125; finally &#123;</span><br><span class="line">        JDBCUtils.close(pstmt1,conn);</span><br><span class="line">        JDBCUtils.close(pstmt2,null);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://misswanglove.github.io/WangZhi.github.io/WangZhi.github.io/2018/08/09/mysql/day03-多表/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="王智家园">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/WangZhi.github.io/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="IT小白进阶">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/WangZhi.github.io/2018/08/09/mysql/day03-多表/" itemprop="url">day03 多表</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-08-09T17:51:16+08:00">
                2018-08-09
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/WangZhi.github.io/categories/Mysql/" itemprop="url" rel="index">
                    <span itemprop="name">Mysql</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="今日内容"><a href="#今日内容" class="headerlink" title="今日内容"></a>今日内容</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1. 多表查询</span><br><span class="line"></span><br><span class="line">2. 事务</span><br><span class="line"></span><br><span class="line">3. DCL</span><br></pre></td></tr></table></figure>
<h2 id="多表查询："><a href="#多表查询：" class="headerlink" title="多表查询："></a>多表查询：</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">* 查询语法：</span><br><span class="line">	select</span><br><span class="line">		列名列表</span><br><span class="line">	from</span><br><span class="line">		表名列表</span><br><span class="line">	where....</span><br><span class="line">* 准备sql</span><br><span class="line">	# 创建部门表</span><br><span class="line">	CREATE TABLE dept(</span><br><span class="line">		id INT PRIMARY KEY AUTO_INCREMENT,</span><br><span class="line">		NAME VARCHAR(20)</span><br><span class="line">	);</span><br><span class="line">	INSERT INTO dept (NAME) VALUES (&apos;开发部&apos;),(&apos;市场部&apos;),(&apos;财务部&apos;);</span><br><span class="line">	# 创建员工表</span><br><span class="line">	CREATE TABLE emp (</span><br><span class="line">		id INT PRIMARY KEY AUTO_INCREMENT,</span><br><span class="line">		NAME VARCHAR(10),</span><br><span class="line">		gender CHAR(1), -- 性别</span><br><span class="line">		salary DOUBLE, -- 工资</span><br><span class="line">		join_date DATE, -- 入职日期</span><br><span class="line">		dept_id INT,</span><br><span class="line">		FOREIGN KEY (dept_id) REFERENCES dept(id) -- 外键，关联部门表(部门表的主键)</span><br><span class="line">	);</span><br><span class="line">	INSERT INTO emp(NAME,gender,salary,join_date,dept_id) VALUES(&apos;孙悟空&apos;,&apos;男&apos;,7200,&apos;2013-02-24&apos;,1);</span><br><span class="line">	INSERT INTO emp(NAME,gender,salary,join_date,dept_id) VALUES(&apos;猪八戒&apos;,&apos;男&apos;,3600,&apos;2010-12-02&apos;,2);</span><br><span class="line">	INSERT INTO emp(NAME,gender,salary,join_date,dept_id) VALUES(&apos;唐僧&apos;,&apos;男&apos;,9000,&apos;2008-08-08&apos;,2);</span><br><span class="line">	INSERT INTO emp(NAME,gender,salary,join_date,dept_id) VALUES(&apos;白骨精&apos;,&apos;女&apos;,5000,&apos;2015-10-07&apos;,3);</span><br><span class="line">	INSERT INTO emp(NAME,gender,salary,join_date,dept_id) VALUES(&apos;蜘蛛精&apos;,&apos;女&apos;,4500,&apos;2011-03-14&apos;,1);</span><br><span class="line">* 笛卡尔积：</span><br><span class="line">	* 有两个集合A,B .取这两个集合的所有组成情况。</span><br><span class="line">	* 要完成多表查询，需要消除无用的数据</span><br><span class="line">* 多表查询的分类：</span><br><span class="line">	1. 内连接查询：</span><br><span class="line">		1. 隐式内连接：使用where条件消除无用数据</span><br><span class="line">			* 例子：</span><br><span class="line">			-- 查询所有员工信息和对应的部门信息</span><br><span class="line"></span><br><span class="line">			SELECT * FROM emp,dept WHERE emp.`dept_id` = dept.`id`;</span><br><span class="line">			</span><br><span class="line">			-- 查询员工表的名称，性别。部门表的名称</span><br><span class="line">			SELECT emp.name,emp.gender,dept.name FROM emp,dept WHERE emp.`dept_id` = dept.`id`;</span><br><span class="line">			</span><br><span class="line">			SELECT </span><br><span class="line">				t1.name, -- 员工表的姓名</span><br><span class="line">				t1.gender,-- 员工表的性别</span><br><span class="line">				t2.name -- 部门表的名称</span><br><span class="line">			FROM</span><br><span class="line">				emp t1,</span><br><span class="line">				dept t2</span><br><span class="line">			WHERE </span><br><span class="line">				t1.`dept_id` = t2.`id`;</span><br></pre></td></tr></table></figure>
<p>​    </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line">	2. 显式内连接：</span><br><span class="line">		* 语法： select 字段列表 from 表名1 [inner] join 表名2 on 条件</span><br><span class="line">		* 例如：</span><br><span class="line">			* SELECT * FROM emp INNER JOIN dept ON emp.`dept_id` = dept.`id`;	</span><br><span class="line">			* SELECT * FROM emp JOIN dept ON emp.`dept_id` = dept.`id`;	</span><br><span class="line"></span><br><span class="line">	3. 内连接查询：</span><br><span class="line">		1. 从哪些表中查询数据</span><br><span class="line">		2. 条件是什么</span><br><span class="line">		3. 查询哪些字段</span><br><span class="line">2. 外链接查询：</span><br><span class="line">	1. 左外连接：</span><br><span class="line">		* 语法：select 字段列表 from 表1 left [outer] join 表2 on 条件；</span><br><span class="line">		* 查询的是左表所有数据以及其交集部分。</span><br><span class="line">		* 例子：</span><br><span class="line">			-- 查询所有员工信息，如果员工有部门，则查询部门名称，没有部门，则不显示部门名称</span><br><span class="line">			SELECT 	t1.*,t2.`name` FROM emp t1 LEFT JOIN dept t2 ON t1.`dept_id` = t2.`id`;</span><br><span class="line">	2. 右外连接：</span><br><span class="line">		* 语法：select 字段列表 from 表1 right [outer] join 表2 on 条件；</span><br><span class="line">		* 查询的是右表所有数据以及其交集部分。</span><br><span class="line">		* 例子：</span><br><span class="line">			SELECT 	* FROM dept t2 RIGHT JOIN emp t1 ON t1.`dept_id` = t2.`id`;</span><br><span class="line">3. 子查询：</span><br><span class="line">	* 概念：查询中嵌套查询，称嵌套查询为子查询。</span><br><span class="line">		-- 查询工资最高的员工信息</span><br><span class="line">		-- 1 查询最高的工资是多少 9000</span><br><span class="line">		SELECT MAX(salary) FROM emp;</span><br><span class="line">		</span><br><span class="line">		-- 2 查询员工信息，并且工资等于9000的</span><br><span class="line">		SELECT * FROM emp WHERE emp.`salary` = 9000;</span><br><span class="line">		</span><br><span class="line">		-- 一条sql就完成这个操作。子查询</span><br><span class="line">		SELECT * FROM emp WHERE emp.`salary` = (SELECT MAX(salary) FROM emp);</span><br><span class="line"></span><br><span class="line">	* 子查询不同情况</span><br><span class="line">		1. 子查询的结果是单行单列的：</span><br><span class="line">			* 子查询可以作为条件，使用运算符去判断。 运算符： &gt; &gt;= &lt; &lt;= =</span><br><span class="line">			* </span><br><span class="line">			-- 查询员工工资小于平均工资的人</span><br><span class="line">			SELECT * FROM emp WHERE emp.salary &lt; (SELECT AVG(salary) FROM emp);</span><br><span class="line">		2. 子查询的结果是多行单列的：</span><br><span class="line">			* 子查询可以作为条件，使用运算符in来判断</span><br><span class="line">			-- 查询&apos;财务部&apos;和&apos;市场部&apos;所有的员工信息</span><br><span class="line">			SELECT id FROM dept WHERE NAME = &apos;财务部&apos; OR NAME = &apos;市场部&apos;;</span><br><span class="line">			SELECT * FROM emp WHERE dept_id = 3 OR dept_id = 2;</span><br><span class="line">			-- 子查询</span><br><span class="line">			SELECT * FROM emp WHERE dept_id IN (SELECT id FROM dept WHERE NAME = &apos;财务部&apos; OR NAME = &apos;市场部&apos;);</span><br><span class="line"></span><br><span class="line">		3. 子查询的结果是多行多列的：</span><br><span class="line">			* 子查询可以作为一张虚拟表参与查询</span><br><span class="line">			-- 查询员工入职日期是2011-11-11日之后的员工信息和部门信息</span><br><span class="line">			-- 子查询</span><br><span class="line">			SELECT * FROM dept t1 ,(SELECT * FROM emp WHERE emp.`join_date` &gt; &apos;2011-11-11&apos;) t2</span><br><span class="line">			WHERE t1.id = t2.dept_id;</span><br><span class="line">			</span><br><span class="line">			-- 普通内连接</span><br><span class="line">			SELECT * FROM emp t1,dept t2 WHERE t1.`dept_id` = t2.`id` AND t1.`join_date` &gt;  &apos;2011-11-11&apos;</span><br><span class="line"></span><br><span class="line">* 多表查询练习</span><br><span class="line"></span><br><span class="line">		-- 部门表</span><br><span class="line">		CREATE TABLE dept (</span><br><span class="line">		  id INT PRIMARY KEY PRIMARY KEY, -- 部门id</span><br><span class="line">		  dname VARCHAR(50), -- 部门名称</span><br><span class="line">		  loc VARCHAR(50) -- 部门所在地</span><br><span class="line">		);</span><br><span class="line">		</span><br><span class="line">		-- 添加4个部门</span><br><span class="line">		INSERT INTO dept(id,dname,loc) VALUES </span><br><span class="line">		(10,&apos;教研部&apos;,&apos;北京&apos;),</span><br><span class="line">		(20,&apos;学工部&apos;,&apos;上海&apos;),</span><br><span class="line">		(30,&apos;销售部&apos;,&apos;广州&apos;),</span><br><span class="line">		(40,&apos;财务部&apos;,&apos;深圳&apos;);</span><br></pre></td></tr></table></figure>
<p>​<br>​                </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">-- 职务表，职务名称，职务描述</span><br><span class="line">CREATE TABLE job (</span><br><span class="line">  id INT PRIMARY KEY,</span><br><span class="line">  jname VARCHAR(20),</span><br><span class="line">  description VARCHAR(50)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">-- 添加4个职务</span><br><span class="line">INSERT INTO job (id, jname, description) VALUES</span><br><span class="line">(1, &apos;董事长&apos;, &apos;管理整个公司，接单&apos;),</span><br><span class="line">(2, &apos;经理&apos;, &apos;管理部门员工&apos;),</span><br><span class="line">(3, &apos;销售员&apos;, &apos;向客人推销产品&apos;),</span><br><span class="line">(4, &apos;文员&apos;, &apos;使用办公软件&apos;);</span><br></pre></td></tr></table></figure>
<p>​<br>​                </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">-- 员工表</span><br><span class="line">CREATE TABLE emp (</span><br><span class="line">  id INT PRIMARY KEY, -- 员工id</span><br><span class="line">  ename VARCHAR(50), -- 员工姓名</span><br><span class="line">  job_id INT, -- 职务id</span><br><span class="line">  mgr INT , -- 上级领导</span><br><span class="line">  joindate DATE, -- 入职日期</span><br><span class="line">  salary DECIMAL(7,2), -- 工资</span><br><span class="line">  bonus DECIMAL(7,2), -- 奖金</span><br><span class="line">  dept_id INT, -- 所在部门编号</span><br><span class="line">  CONSTRAINT emp_jobid_ref_job_id_fk FOREIGN KEY (job_id) REFERENCES job (id),</span><br><span class="line">  CONSTRAINT emp_deptid_ref_dept_id_fk FOREIGN KEY (dept_id) REFERENCES dept (id)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">-- 添加员工</span><br><span class="line">INSERT INTO emp(id,ename,job_id,mgr,joindate,salary,bonus,dept_id) VALUES </span><br><span class="line">(1001,&apos;孙悟空&apos;,4,1004,&apos;2000-12-17&apos;,&apos;8000.00&apos;,NULL,20),</span><br><span class="line">(1002,&apos;卢俊义&apos;,3,1006,&apos;2001-02-20&apos;,&apos;16000.00&apos;,&apos;3000.00&apos;,30),</span><br><span class="line">(1003,&apos;林冲&apos;,3,1006,&apos;2001-02-22&apos;,&apos;12500.00&apos;,&apos;5000.00&apos;,30),</span><br><span class="line">(1004,&apos;唐僧&apos;,2,1009,&apos;2001-04-02&apos;,&apos;29750.00&apos;,NULL,20),</span><br><span class="line">(1005,&apos;李逵&apos;,4,1006,&apos;2001-09-28&apos;,&apos;12500.00&apos;,&apos;14000.00&apos;,30),</span><br><span class="line">(1006,&apos;宋江&apos;,2,1009,&apos;2001-05-01&apos;,&apos;28500.00&apos;,NULL,30),</span><br><span class="line">(1007,&apos;刘备&apos;,2,1009,&apos;2001-09-01&apos;,&apos;24500.00&apos;,NULL,10),</span><br><span class="line">(1008,&apos;猪八戒&apos;,4,1004,&apos;2007-04-19&apos;,&apos;30000.00&apos;,NULL,20),</span><br><span class="line">(1009,&apos;罗贯中&apos;,1,NULL,&apos;2001-11-17&apos;,&apos;50000.00&apos;,NULL,10),</span><br><span class="line">(1010,&apos;吴用&apos;,3,1006,&apos;2001-09-08&apos;,&apos;15000.00&apos;,&apos;0.00&apos;,30),</span><br><span class="line">(1011,&apos;沙僧&apos;,4,1004,&apos;2007-05-23&apos;,&apos;11000.00&apos;,NULL,20),</span><br><span class="line">(1012,&apos;李逵&apos;,4,1006,&apos;2001-12-03&apos;,&apos;9500.00&apos;,NULL,30),</span><br><span class="line">(1013,&apos;小白龙&apos;,4,1004,&apos;2001-12-03&apos;,&apos;30000.00&apos;,NULL,20),</span><br><span class="line">(1014,&apos;关羽&apos;,4,1007,&apos;2002-01-23&apos;,&apos;13000.00&apos;,NULL,10);</span><br></pre></td></tr></table></figure>
<p>​<br>​                </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">-- 工资等级表</span><br><span class="line">CREATE TABLE salarygrade (</span><br><span class="line">  grade INT PRIMARY KEY,   -- 级别</span><br><span class="line">  losalary INT,  -- 最低工资</span><br><span class="line">  hisalary INT -- 最高工资</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">-- 添加5个工资等级</span><br><span class="line">INSERT INTO salarygrade(grade,losalary,hisalary) VALUES </span><br><span class="line">(1,7000,12000),</span><br><span class="line">(2,12010,14000),</span><br><span class="line">(3,14010,20000),</span><br><span class="line">(4,20010,30000),</span><br><span class="line">(5,30010,99990);</span><br><span class="line"></span><br><span class="line">-- 需求：</span><br><span class="line"></span><br><span class="line">-- 1.查询所有员工信息。查询员工编号，员工姓名，工资，职务名称，职务描述</span><br><span class="line">/*</span><br><span class="line">	分析：</span><br><span class="line">		1.员工编号，员工姓名，工资，需要查询emp表  职务名称，职务描述 需要查询job表</span><br><span class="line">		2.查询条件 emp.job_id = job.id</span><br><span class="line"></span><br><span class="line">*/</span><br><span class="line">SELECT </span><br><span class="line">	t1.`id`, -- 员工编号</span><br><span class="line">	t1.`ename`, -- 员工姓名</span><br><span class="line">	t1.`salary`,-- 工资</span><br><span class="line">	t2.`jname`, -- 职务名称</span><br><span class="line">	t2.`description` -- 职务描述</span><br><span class="line">FROM </span><br><span class="line">	emp t1, job t2</span><br><span class="line">WHERE </span><br><span class="line">	t1.`job_id` = t2.`id`;</span><br></pre></td></tr></table></figure>
<p>​<br>​                </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">-- 2.查询员工编号，员工姓名，工资，职务名称，职务描述，部门名称，部门位置</span><br><span class="line">/*</span><br><span class="line">	分析：</span><br><span class="line">		1. 员工编号，员工姓名，工资 emp  职务名称，职务描述 job  部门名称，部门位置 dept</span><br><span class="line">		2. 条件： emp.job_id = job.id and emp.dept_id = dept.id</span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">SELECT </span><br><span class="line">	t1.`id`, -- 员工编号</span><br><span class="line">	t1.`ename`, -- 员工姓名</span><br><span class="line">	t1.`salary`,-- 工资</span><br><span class="line">	t2.`jname`, -- 职务名称</span><br><span class="line">	t2.`description`, -- 职务描述</span><br><span class="line">	t3.`dname`, -- 部门名称</span><br><span class="line">	t3.`loc` -- 部门位置</span><br><span class="line">FROM </span><br><span class="line">	emp t1, job t2,dept t3</span><br><span class="line">WHERE </span><br><span class="line">	t1.`job_id` = t2.`id` AND t1.`dept_id` = t3.`id`;</span><br><span class="line">   </span><br><span class="line">-- 3.查询员工姓名，工资，工资等级</span><br><span class="line">/*</span><br><span class="line">	分析：</span><br><span class="line">		1.员工姓名，工资 emp  工资等级 salarygrade</span><br><span class="line">		2.条件 emp.salary &gt;= salarygrade.losalary and emp.salary &lt;= salarygrade.hisalary</span><br><span class="line">			emp.salary BETWEEN salarygrade.losalary and salarygrade.hisalary</span><br><span class="line">*/</span><br><span class="line">SELECT </span><br><span class="line">	t1.ename ,</span><br><span class="line">	t1.`salary`,</span><br><span class="line">	t2.*</span><br><span class="line">FROM emp t1, salarygrade t2</span><br><span class="line">WHERE t1.`salary` BETWEEN t2.`losalary` AND t2.`hisalary`;</span><br></pre></td></tr></table></figure>
<p>​<br>​                </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">-- 4.查询员工姓名，工资，职务名称，职务描述，部门名称，部门位置，工资等级</span><br><span class="line">/*</span><br><span class="line">	分析：</span><br><span class="line">		1. 员工姓名，工资 emp ， 职务名称，职务描述 job 部门名称，部门位置，dept  工资等级 salarygrade</span><br><span class="line">		2. 条件： emp.job_id = job.id and emp.dept_id = dept.id and emp.salary BETWEEN salarygrade.losalary and salarygrade.hisalary</span><br><span class="line">			</span><br><span class="line">*/</span><br><span class="line">SELECT </span><br><span class="line">	t1.`ename`,</span><br><span class="line">	t1.`salary`,</span><br><span class="line">	t2.`jname`,</span><br><span class="line">	t2.`description`,</span><br><span class="line">	t3.`dname`,</span><br><span class="line">	t3.`loc`,</span><br><span class="line">	t4.`grade`</span><br><span class="line">FROM </span><br><span class="line">	emp t1,job t2,dept t3,salarygrade t4</span><br><span class="line">WHERE </span><br><span class="line">	t1.`job_id` = t2.`id` </span><br><span class="line">	AND t1.`dept_id` = t3.`id`</span><br><span class="line">	AND t1.`salary` BETWEEN t4.`losalary` AND t4.`hisalary`;</span><br></pre></td></tr></table></figure>
<p>​<br>​                </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">-- 5.查询出部门编号、部门名称、部门位置、部门人数</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line">	分析：</span><br><span class="line">		1.部门编号、部门名称、部门位置 dept 表。 部门人数 emp表</span><br><span class="line">		2.使用分组查询。按照emp.dept_id完成分组，查询count(id)</span><br><span class="line">		3.使用子查询将第2步的查询结果和dept表进行关联查询</span><br><span class="line">		</span><br><span class="line">*/</span><br><span class="line">SELECT </span><br><span class="line">	t1.`id`,t1.`dname`,t1.`loc` , t2.total</span><br><span class="line">FROM </span><br><span class="line">	dept t1,</span><br><span class="line">	(SELECT</span><br><span class="line">		dept_id,COUNT(id) total</span><br><span class="line">	FROM </span><br><span class="line">		emp</span><br><span class="line">	GROUP BY dept_id) t2</span><br><span class="line">WHERE t1.`id` = t2.dept_id;</span><br></pre></td></tr></table></figure>
<p>​                </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">-- 6.查询所有员工的姓名及其直接上级的姓名,没有领导的员工也需要查询</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line">	分析：</span><br><span class="line">		1.姓名 emp， 直接上级的姓名 emp</span><br><span class="line">			* emp表的id 和 mgr 是自关联</span><br><span class="line">		2.条件 emp.id = emp.mgr</span><br><span class="line">		3.查询左表的所有数据，和 交集数据</span><br><span class="line">			* 使用左外连接查询</span><br><span class="line">	</span><br><span class="line">*/</span><br><span class="line">/*</span><br><span class="line">select</span><br><span class="line">	t1.ename,</span><br><span class="line">	t1.mgr,</span><br><span class="line">	t2.`id`,</span><br><span class="line">	t2.ename</span><br><span class="line">from emp t1, emp t2</span><br><span class="line">where t1.mgr = t2.`id`;</span><br><span class="line"></span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">SELECT </span><br><span class="line">	t1.ename,</span><br><span class="line">	t1.mgr,</span><br><span class="line">	t2.`id`,</span><br><span class="line">	t2.`ename`</span><br><span class="line">FROM emp t1</span><br><span class="line">LEFT JOIN emp t2</span><br><span class="line">ON t1.`mgr` = t2.`id`;</span><br></pre></td></tr></table></figure>
<h2 id="事务"><a href="#事务" class="headerlink" title="事务"></a>事务</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">1. 事务的基本介绍</span><br><span class="line">	1. 概念：</span><br><span class="line">		*  如果一个包含多个步骤的业务操作，被事务管理，那么这些操作要么同时成功，要么同时失败。</span><br><span class="line">		</span><br><span class="line">	2. 操作：</span><br><span class="line">		1. 开启事务： start transaction;</span><br><span class="line">		2. 回滚：rollback;</span><br><span class="line">		3. 提交：commit;</span><br><span class="line">	3. 例子：</span><br><span class="line">		CREATE TABLE account (</span><br><span class="line">			id INT PRIMARY KEY AUTO_INCREMENT,</span><br><span class="line">			NAME VARCHAR(10),</span><br><span class="line">			balance DOUBLE</span><br><span class="line">		);</span><br><span class="line">		-- 添加数据</span><br><span class="line">		INSERT INTO account (NAME, balance) VALUES (&apos;zhangsan&apos;, 1000), (&apos;lisi&apos;, 1000);</span><br></pre></td></tr></table></figure>
<p>​            </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">	SELECT * FROM account;</span><br><span class="line">	UPDATE account SET balance = 1000;</span><br><span class="line">	-- 张三给李四转账 500 元</span><br><span class="line">	</span><br><span class="line">	-- 0. 开启事务</span><br><span class="line">	START TRANSACTION;</span><br><span class="line">	-- 1. 张三账户 -500</span><br><span class="line">	</span><br><span class="line">	UPDATE account SET balance = balance - 500 WHERE NAME = &apos;zhangsan&apos;;</span><br><span class="line">	-- 2. 李四账户 +500</span><br><span class="line">	-- 出错了...</span><br><span class="line">	UPDATE account SET balance = balance + 500 WHERE NAME = &apos;lisi&apos;;</span><br><span class="line">	</span><br><span class="line">	-- 发现执行没有问题，提交事务</span><br><span class="line">	COMMIT;</span><br><span class="line">	</span><br><span class="line">	-- 发现出问题了，回滚事务</span><br><span class="line">	ROLLBACK;</span><br><span class="line">4. MySQL数据库中事务默认自动提交</span><br><span class="line">	</span><br><span class="line">	* 事务提交的两种方式：</span><br><span class="line">		* 自动提交：</span><br><span class="line">			* mysql就是自动提交的</span><br><span class="line">			* 一条DML(增删改)语句会自动提交一次事务。</span><br><span class="line">		* 手动提交：</span><br><span class="line">			* Oracle 数据库默认是手动提交事务</span><br><span class="line">			* 需要先开启事务，再提交</span><br><span class="line">	* 修改事务的默认提交方式：</span><br><span class="line">		* 查看事务的默认提交方式：SELECT @@autocommit; -- 1 代表自动提交  0 代表手动提交</span><br><span class="line">		* 修改默认提交方式： set @@autocommit = 0;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">2. 事务的四大特征：</span><br><span class="line">	1. 原子性：是不可分割的最小操作单位，要么同时成功，要么同时失败。</span><br><span class="line">	2. 持久性：当事务提交或回滚后，数据库会持久化的保存数据。</span><br><span class="line">	3. 隔离性：多个事务之间。相互独立。</span><br><span class="line">	4. 一致性：事务操作前后，数据总量不变</span><br><span class="line">3. 事务的隔离级别（了解）</span><br><span class="line">	* 概念：多个事务之间隔离的，相互独立的。但是如果多个事务操作同一批数据，则会引发一些问题，设置不同的隔离级别就可以解决这些问题。</span><br><span class="line">	* 存在问题：</span><br><span class="line">		1. 脏读：一个事务，读取到另一个事务中没有提交的数据</span><br><span class="line">		2. 不可重复读(虚读)：在同一个事务中，两次读取到的数据不一样。</span><br><span class="line">		3. 幻读：一个事务操作(DML)数据表中所有记录，另一个事务添加了一条数据，则第一个事务查询不到自己的修改。</span><br><span class="line">	* 隔离级别：</span><br><span class="line">		1. read uncommitted：读未提交</span><br><span class="line">			* 产生的问题：脏读、不可重复读、幻读</span><br><span class="line">		2. read committed：读已提交 （Oracle）</span><br><span class="line">			* 产生的问题：不可重复读、幻读</span><br><span class="line">		3. repeatable read：可重复读 （MySQL默认）</span><br><span class="line">			* 产生的问题：幻读</span><br><span class="line">		4. serializable：串行化</span><br><span class="line">			* 可以解决所有的问题</span><br><span class="line"></span><br><span class="line">		* 注意：隔离级别从小到大安全性越来越高，但是效率越来越低</span><br><span class="line">		* 数据库查询隔离级别：</span><br><span class="line">			* select @@tx_isolation;</span><br><span class="line">		* 数据库设置隔离级别：</span><br><span class="line">			* set global transaction isolation level  级别字符串;</span><br><span class="line"></span><br><span class="line">	* 演示：</span><br><span class="line">		set global transaction isolation level read uncommitted;</span><br><span class="line">		start transaction;</span><br><span class="line">		-- 转账操作</span><br><span class="line">		update account set balance = balance - 500 where id = 1;</span><br><span class="line">		update account set balance = balance + 500 where id = 2;</span><br></pre></td></tr></table></figure>
<h2 id="DCL："><a href="#DCL：" class="headerlink" title="DCL："></a>DCL：</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">* SQL分类：</span><br><span class="line">	1. DDL：操作数据库和表</span><br><span class="line">	2. DML：增删改表中数据</span><br><span class="line">	3. DQL：查询表中数据</span><br><span class="line">	4. DCL：管理用户，授权</span><br><span class="line"></span><br><span class="line">* DBA：数据库管理员</span><br><span class="line"></span><br><span class="line">* DCL：管理用户，授权</span><br><span class="line">	1. 管理用户</span><br><span class="line">		1. 添加用户：</span><br><span class="line">			* 语法：CREATE USER &apos;用户名&apos;@&apos;主机名&apos; IDENTIFIED BY &apos;密码&apos;;</span><br><span class="line">		2. 删除用户：</span><br><span class="line">			* 语法：DROP USER &apos;用户名&apos;@&apos;主机名&apos;;</span><br><span class="line">		3. 修改用户密码：</span><br><span class="line">			</span><br><span class="line">			UPDATE USER SET PASSWORD = PASSWORD(&apos;新密码&apos;) WHERE USER = &apos;用户名&apos;;</span><br><span class="line">			UPDATE USER SET PASSWORD = PASSWORD(&apos;abc&apos;) WHERE USER = &apos;lisi&apos;;</span><br><span class="line">			</span><br><span class="line">			SET PASSWORD FOR &apos;用户名&apos;@&apos;主机名&apos; = PASSWORD(&apos;新密码&apos;);</span><br><span class="line">			SET PASSWORD FOR &apos;root&apos;@&apos;localhost&apos; = PASSWORD(&apos;123&apos;);</span><br><span class="line"></span><br><span class="line">			* mysql中忘记了root用户的密码？</span><br><span class="line">				1. cmd -- &gt; net stop mysql 停止mysql服务</span><br><span class="line">					* 需要管理员运行该cmd</span><br><span class="line"></span><br><span class="line">				2. 使用无验证方式启动mysql服务： mysqld --skip-grant-tables</span><br><span class="line">				3. 打开新的cmd窗口,直接输入mysql命令，敲回车。就可以登录成功</span><br><span class="line">				4. use mysql;</span><br><span class="line">				5. update user set password = password(&apos;你的新密码&apos;) where user = &apos;root&apos;;</span><br><span class="line">				6. 关闭两个窗口</span><br><span class="line">				7. 打开任务管理器，手动结束mysqld.exe 的进程</span><br><span class="line">				8. 启动mysql服务</span><br><span class="line">				9. 使用新密码登录。</span><br><span class="line">		4. 查询用户：</span><br><span class="line">			-- 1. 切换到mysql数据库</span><br><span class="line">			USE myql;</span><br><span class="line">			-- 2. 查询user表</span><br><span class="line">			SELECT * FROM USER;</span><br><span class="line">			</span><br><span class="line">			* 通配符： % 表示可以在任意主机使用用户登录数据库</span><br><span class="line"></span><br><span class="line">	2. 权限管理：</span><br><span class="line">		1. 查询权限：</span><br><span class="line">			-- 查询权限</span><br><span class="line">			SHOW GRANTS FOR &apos;用户名&apos;@&apos;主机名&apos;;</span><br><span class="line">			SHOW GRANTS FOR &apos;lisi&apos;@&apos;%&apos;;</span><br><span class="line"></span><br><span class="line">		2. 授予权限：</span><br><span class="line">			-- 授予权限</span><br><span class="line">			grant 权限列表 on 数据库名.表名 to &apos;用户名&apos;@&apos;主机名&apos;;</span><br><span class="line">			-- 给张三用户授予所有权限，在任意数据库任意表上</span><br><span class="line">			</span><br><span class="line">			GRANT ALL ON *.* TO &apos;zhangsan&apos;@&apos;localhost&apos;;</span><br><span class="line">		3. 撤销权限：</span><br><span class="line">			-- 撤销权限：</span><br><span class="line">			revoke 权限列表 on 数据库名.表名 from &apos;用户名&apos;@&apos;主机名&apos;;</span><br><span class="line">			REVOKE UPDATE ON db3.`account` FROM &apos;lisi&apos;@&apos;%&apos;;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://misswanglove.github.io/WangZhi.github.io/WangZhi.github.io/2018/08/09/mysql/day02-约束/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="王智家园">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/WangZhi.github.io/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="IT小白进阶">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/WangZhi.github.io/2018/08/09/mysql/day02-约束/" itemprop="url">day02 约束</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-08-09T17:50:52+08:00">
                2018-08-09
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/WangZhi.github.io/categories/Mysql/" itemprop="url" rel="index">
                    <span itemprop="name">Mysql</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="今日内容"><a href="#今日内容" class="headerlink" title="今日内容"></a>今日内容</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">1. DQL:查询语句</span><br><span class="line">	1. 排序查询</span><br><span class="line">	2. 聚合函数</span><br><span class="line">	3. 分组查询</span><br><span class="line">	4. 分页查询</span><br><span class="line"></span><br><span class="line">2. 约束</span><br><span class="line">3. 多表之间的关系</span><br><span class="line">4. 范式</span><br><span class="line">5. 数据库的备份和还原</span><br></pre></td></tr></table></figure>
<h1 id="DQL-查询语句"><a href="#DQL-查询语句" class="headerlink" title="DQL:查询语句"></a>DQL:查询语句</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">1. 排序查询</span><br><span class="line">	* 语法：order by 子句</span><br><span class="line">		* order by 排序字段1 排序方式1 ，  排序字段2 排序方式2...</span><br><span class="line"></span><br><span class="line">	* 排序方式：</span><br><span class="line">		* ASC：升序，默认的。</span><br><span class="line">		* DESC：降序。</span><br><span class="line"></span><br><span class="line">	* 注意：</span><br><span class="line">		* 如果有多个排序条件，则当前边的条件值一样时，才会判断第二条件。</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">2. 聚合函数：将一列数据作为一个整体，进行纵向的计算。</span><br><span class="line">	1. count：计算个数</span><br><span class="line">		1. 一般选择非空的列：主键</span><br><span class="line">		2. count(*)</span><br><span class="line">	2. max：计算最大值</span><br><span class="line">	3. min：计算最小值</span><br><span class="line">	4. sum：计算和</span><br><span class="line">	5. avg：计算平均值</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">	* 注意：聚合函数的计算，排除null值。</span><br><span class="line">		解决方案：</span><br><span class="line">			1. 选择不包含非空的列进行计算</span><br><span class="line">			2. IFNULL函数</span><br><span class="line"></span><br><span class="line">3. 分组查询:</span><br><span class="line">	1. 语法：group by 分组字段；</span><br><span class="line">	2. 注意：</span><br><span class="line">		1. 分组之后查询的字段：分组字段、聚合函数</span><br><span class="line">		2. where 和 having 的区别？</span><br><span class="line">			1. where 在分组之前进行限定，如果不满足条件，则不参与分组。having在分组之后进行限定，如果不满足结果，则不会被查询出来</span><br><span class="line">			2. where 后不可以跟聚合函数，having可以进行聚合函数的判断。</span><br><span class="line"></span><br><span class="line">		-- 按照性别分组。分别查询男、女同学的平均分</span><br><span class="line"></span><br><span class="line">		SELECT sex , AVG(math) FROM student GROUP BY sex;</span><br><span class="line">		</span><br><span class="line">		-- 按照性别分组。分别查询男、女同学的平均分,人数</span><br><span class="line">		</span><br><span class="line">		SELECT sex , AVG(math),COUNT(id) FROM student GROUP BY sex;</span><br><span class="line">		</span><br><span class="line">		--  按照性别分组。分别查询男、女同学的平均分,人数 要求：分数低于70分的人，不参与分组</span><br><span class="line">		SELECT sex , AVG(math),COUNT(id) FROM student WHERE math &gt; 70 GROUP BY sex;</span><br><span class="line">		</span><br><span class="line">		--  按照性别分组。分别查询男、女同学的平均分,人数 要求：分数低于70分的人，不参与分组,分组之后。人数要大于2个人</span><br><span class="line">		SELECT sex , AVG(math),COUNT(id) FROM student WHERE math &gt; 70 GROUP BY sex HAVING COUNT(id) &gt; 2;</span><br><span class="line">		</span><br><span class="line">		SELECT sex , AVG(math),COUNT(id) 人数 FROM student WHERE math &gt; 70 GROUP BY sex HAVING 人数 &gt; 2;</span><br></pre></td></tr></table></figure>
<p>​            </p>
<pre><code>4. 分页查询
    1. 语法：limit 开始的索引,每页查询的条数;
    2. 公式：开始的索引 = （当前的页码 - 1） * 每页显示的条数
        -- 每页显示3条记录 
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">	SELECT * FROM student LIMIT 0,3; -- 第1页</span><br><span class="line">	</span><br><span class="line">	SELECT * FROM student LIMIT 3,3; -- 第2页</span><br><span class="line">	</span><br><span class="line">	SELECT * FROM student LIMIT 6,3; -- 第3页</span><br><span class="line"></span><br><span class="line">3. limit 是一个MySQL&quot;方言&quot;</span><br></pre></td></tr></table></figure>
<h2 id="约束"><a href="#约束" class="headerlink" title="约束"></a>约束</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">* 概念： 对表中的数据进行限定，保证数据的正确性、有效性和完整性。	</span><br><span class="line">* 分类：</span><br><span class="line">	1. 主键约束：primary key</span><br><span class="line">	2. 非空约束：not null</span><br><span class="line">	3. 唯一约束：unique</span><br><span class="line">	4. 外键约束：foreign key</span><br><span class="line"></span><br><span class="line">* 非空约束：not null，值不能为null</span><br><span class="line">	1. 创建表时添加约束</span><br><span class="line">		CREATE TABLE stu(</span><br><span class="line">			id INT,</span><br><span class="line">			NAME VARCHAR(20) NOT NULL -- name为非空</span><br><span class="line">		);</span><br><span class="line">	2. 创建表完后，添加非空约束</span><br><span class="line">		ALTER TABLE stu MODIFY NAME VARCHAR(20) NOT NULL;</span><br><span class="line"></span><br><span class="line">	3. 删除name的非空约束</span><br><span class="line">		ALTER TABLE stu MODIFY NAME VARCHAR(20);</span><br></pre></td></tr></table></figure>
<p>​    </p>
<pre><code>* 唯一约束：unique，值不能重复
    1. 创建表时，添加唯一约束
        CREATE TABLE stu(
            id INT,
            phone_number VARCHAR(20) UNIQUE -- 添加了唯一约束
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">);</span><br><span class="line">* 注意mysql中，唯一约束限定的列的值可以有多个null</span><br></pre></td></tr></table></figure>
<p>​        </p>
<pre><code>2. 删除唯一约束
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">		ALTER TABLE stu DROP INDEX phone_number;</span><br><span class="line">	</span><br><span class="line">	3. 在创建表后，添加唯一约束</span><br><span class="line">		ALTER TABLE stu MODIFY phone_number VARCHAR(20) UNIQUE;</span><br><span class="line"></span><br><span class="line">* 主键约束：primary key。</span><br><span class="line">	1. 注意：</span><br><span class="line">		1. 含义：非空且唯一</span><br><span class="line">		2. 一张表只能有一个字段为主键</span><br><span class="line">		3. 主键就是表中记录的唯一标识</span><br><span class="line"></span><br><span class="line">	2. 在创建表时，添加主键约束</span><br><span class="line">		create table stu(</span><br><span class="line">			id int primary key,-- 给id添加主键约束</span><br><span class="line">			name varchar(20)</span><br><span class="line">		);</span><br><span class="line"></span><br><span class="line">	3. 删除主键</span><br><span class="line">		-- 错误 alter table stu modify id int ;</span><br><span class="line">		ALTER TABLE stu DROP PRIMARY KEY;</span><br><span class="line"></span><br><span class="line">	4. 创建完表后，添加主键</span><br><span class="line">		ALTER TABLE stu MODIFY id INT PRIMARY KEY;</span><br><span class="line"></span><br><span class="line">	5. 自动增长：</span><br><span class="line">		1.  概念：如果某一列是数值类型的，使用 auto_increment 可以来完成值得自动增长</span><br><span class="line"></span><br><span class="line">		2. 在创建表时，添加主键约束，并且完成主键自增长</span><br><span class="line">		create table stu(</span><br><span class="line">			id int primary key auto_increment,-- 给id添加主键约束</span><br><span class="line">			name varchar(20)</span><br><span class="line">		);</span><br></pre></td></tr></table></figure>
<p>​            </p>
<pre><code>3. 删除自动增长
ALTER TABLE stu MODIFY id INT;
4. 添加自动增长
ALTER TABLE stu MODIFY id INT AUTO_INCREMENT;
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">* 外键约束：foreign key,让表于表产生关系，从而保证数据的正确性。</span><br><span class="line">	1. 在创建表时，可以添加外键</span><br><span class="line">		* 语法：</span><br><span class="line">			create table 表名(</span><br><span class="line">				....</span><br><span class="line">				外键列</span><br><span class="line">				constraint 外键名称 foreign key (外键列名称) references 主表名称(主表列名称)</span><br><span class="line">			);</span><br><span class="line"></span><br><span class="line">	2. 删除外键</span><br><span class="line">		ALTER TABLE 表名 DROP FOREIGN KEY 外键名称;</span><br><span class="line"></span><br><span class="line">	3. 创建表之后，添加外键</span><br><span class="line">		ALTER TABLE 表名 ADD CONSTRAINT 外键名称 FOREIGN KEY (外键字段名称) REFERENCES 主表名称(主表列名称);</span><br></pre></td></tr></table></figure>
<p>​        </p>
<pre><code>4. 级联操作
    1. 添加级联操作
        语法：ALTER TABLE 表名 ADD CONSTRAINT 外键名称 
                FOREIGN KEY (外键字段名称) REFERENCES 主表名称(主表列名称) ON UPDATE CASCADE ON DELETE CASCADE  ;
    2. 分类：
        1. 级联更新：ON UPDATE CASCADE 
        2. 级联删除：ON DELETE CASCADE 
</code></pre><h2 id="数据库的设计"><a href="#数据库的设计" class="headerlink" title="数据库的设计"></a>数据库的设计</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line">1. 多表之间的关系</span><br><span class="line">	1. 分类：</span><br><span class="line">		1. 一对一(了解)：</span><br><span class="line">			* 如：人和身份证</span><br><span class="line">			* 分析：一个人只有一个身份证，一个身份证只能对应一个人</span><br><span class="line">		2. 一对多(多对一)：</span><br><span class="line">			* 如：部门和员工</span><br><span class="line">			* 分析：一个部门有多个员工，一个员工只能对应一个部门</span><br><span class="line">		3. 多对多：</span><br><span class="line">			* 如：学生和课程</span><br><span class="line">			* 分析：一个学生可以选择很多门课程，一个课程也可以被很多学生选择</span><br><span class="line">	2. 实现关系：</span><br><span class="line">		1. 一对多(多对一)：</span><br><span class="line">			* 如：部门和员工</span><br><span class="line">			* 实现方式：在多的一方建立外键，指向一的一方的主键。</span><br><span class="line">		2. 多对多：</span><br><span class="line">			* 如：学生和课程</span><br><span class="line">			* 实现方式：多对多关系实现需要借助第三张中间表。中间表至少包含两个字段，这两个字段作为第三张表的外键，分别指向两张表的主键</span><br><span class="line">		3. 一对一(了解)：</span><br><span class="line">			* 如：人和身份证</span><br><span class="line">			* 实现方式：一对一关系实现，可以在任意一方添加唯一外键指向另一方的主键。</span><br><span class="line"></span><br><span class="line">	3. 案例</span><br><span class="line">		-- 创建旅游线路分类表 tab_category</span><br><span class="line">		-- cid 旅游线路分类主键，自动增长</span><br><span class="line">		-- cname 旅游线路分类名称非空，唯一，字符串 100</span><br><span class="line">		CREATE TABLE tab_category (</span><br><span class="line">			cid INT PRIMARY KEY AUTO_INCREMENT,</span><br><span class="line">			cname VARCHAR(100) NOT NULL UNIQUE</span><br><span class="line">		);</span><br><span class="line">		</span><br><span class="line">		-- 创建旅游线路表 tab_route</span><br><span class="line">		/*</span><br><span class="line">		rid 旅游线路主键，自动增长</span><br><span class="line">		rname 旅游线路名称非空，唯一，字符串 100</span><br><span class="line">		price 价格</span><br><span class="line">		rdate 上架时间，日期类型</span><br><span class="line">		cid 外键，所属分类</span><br><span class="line">		*/</span><br><span class="line">		CREATE TABLE tab_route(</span><br><span class="line">			rid INT PRIMARY KEY AUTO_INCREMENT,</span><br><span class="line">			rname VARCHAR(100) NOT NULL UNIQUE,</span><br><span class="line">			price DOUBLE,</span><br><span class="line">			rdate DATE,</span><br><span class="line">			cid INT,</span><br><span class="line">			FOREIGN KEY (cid) REFERENCES tab_category(cid)</span><br><span class="line">		);</span><br><span class="line">		</span><br><span class="line">		/*创建用户表 tab_user</span><br><span class="line">		uid 用户主键，自增长</span><br><span class="line">		username 用户名长度 100，唯一，非空</span><br><span class="line">		password 密码长度 30，非空</span><br><span class="line">		name 真实姓名长度 100</span><br><span class="line">		birthday 生日</span><br><span class="line">		sex 性别，定长字符串 1</span><br><span class="line">		telephone 手机号，字符串 11</span><br><span class="line">		email 邮箱，字符串长度 100</span><br><span class="line">		*/</span><br><span class="line">		CREATE TABLE tab_user (</span><br><span class="line">			uid INT PRIMARY KEY AUTO_INCREMENT,</span><br><span class="line">			username VARCHAR(100) UNIQUE NOT NULL,</span><br><span class="line">			PASSWORD VARCHAR(30) NOT NULL,</span><br><span class="line">			NAME VARCHAR(100),</span><br><span class="line">			birthday DATE,</span><br><span class="line">			sex CHAR(1) DEFAULT &apos;男&apos;,</span><br><span class="line">			telephone VARCHAR(11),</span><br><span class="line">			email VARCHAR(100)</span><br><span class="line">		);</span><br><span class="line">		</span><br><span class="line">		/*</span><br><span class="line">		创建收藏表 tab_favorite</span><br><span class="line">		rid 旅游线路 id，外键</span><br><span class="line">		date 收藏时间</span><br><span class="line">		uid 用户 id，外键</span><br><span class="line">		rid 和 uid 不能重复，设置复合主键，同一个用户不能收藏同一个线路两次</span><br><span class="line">		*/</span><br><span class="line">		CREATE TABLE tab_favorite (</span><br><span class="line">			rid INT, -- 线路id</span><br><span class="line">			DATE DATETIME,</span><br><span class="line">			uid INT, -- 用户id</span><br><span class="line">			-- 创建复合主键</span><br><span class="line">			PRIMARY KEY(rid,uid), -- 联合主键</span><br><span class="line">			FOREIGN KEY (rid) REFERENCES tab_route(rid),</span><br><span class="line">			FOREIGN KEY(uid) REFERENCES tab_user(uid)</span><br><span class="line">		);</span><br></pre></td></tr></table></figure>
<p>​        </p>
<pre><code>2. 数据库设计的范式
    * 概念：设计数据库时，需要遵循的一些规范。要遵循后边的范式要求，必须先遵循前边的所有范式要求
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">	设计关系数据库时，遵从不同的规范要求，设计出合理的关系型数据库，这些不同的规范要求被称为不同的范式，各种范式呈递次规范，越高的范式数据库冗余越小。</span><br><span class="line">	目前关系数据库有六种范式：第一范式（1NF）、第二范式（2NF）、第三范式（3NF）、巴斯-科德范式（BCNF）、第四范式(4NF）和第五范式（5NF，又称完美范式）。</span><br><span class="line"></span><br><span class="line">* 分类：</span><br><span class="line">	1. 第一范式（1NF）：每一列都是不可分割的原子数据项</span><br><span class="line">	2. 第二范式（2NF）：在1NF的基础上，非码属性必须完全依赖于码（在1NF基础上消除非主属性对主码的部分函数依赖）</span><br><span class="line">		* 几个概念：</span><br><span class="line">			1. 函数依赖：A--&gt;B,如果通过A属性(属性组)的值，可以确定唯一B属性的值。则称B依赖于A</span><br><span class="line">				例如：学号--&gt;姓名。  （学号，课程名称） --&gt; 分数</span><br><span class="line">			2. 完全函数依赖：A--&gt;B， 如果A是一个属性组，则B属性值得确定需要依赖于A属性组中所有的属性值。</span><br><span class="line">				例如：（学号，课程名称） --&gt; 分数</span><br><span class="line">			3. 部分函数依赖：A--&gt;B， 如果A是一个属性组，则B属性值得确定只需要依赖于A属性组中某一些值即可。</span><br><span class="line">				例如：（学号，课程名称） -- &gt; 姓名</span><br><span class="line">			4. 传递函数依赖：A--&gt;B, B -- &gt;C . 如果通过A属性(属性组)的值，可以确定唯一B属性的值，在通过B属性（属性组）的值可以确定唯一C属性的值，则称 C 传递函数依赖于A</span><br><span class="line">				例如：学号--&gt;系名，系名--&gt;系主任</span><br><span class="line">			5. 码：如果在一张表中，一个属性或属性组，被其他所有属性所完全依赖，则称这个属性(属性组)为该表的码</span><br><span class="line">				例如：该表中码为：（学号，课程名称）</span><br><span class="line">				* 主属性：码属性组中的所有属性</span><br><span class="line">				* 非主属性：除过码属性组的属性</span><br><span class="line">				</span><br><span class="line">	3. 第三范式（3NF）：在2NF基础上，任何非主属性不依赖于其它非主属性（在2NF基础上消除传递依赖）</span><br></pre></td></tr></table></figure>
<h2 id="数据库的备份和还原"><a href="#数据库的备份和还原" class="headerlink" title="数据库的备份和还原"></a>数据库的备份和还原</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">1. 命令行：</span><br><span class="line">	* 语法：</span><br><span class="line">		* 备份： mysqldump -u用户名 -p密码 数据库名称 &gt; 保存的路径</span><br><span class="line">		* 还原：</span><br><span class="line">			1. 登录数据库</span><br><span class="line">			2. 创建数据库</span><br><span class="line">			3. 使用数据库</span><br><span class="line">			4. 执行文件。source 文件路径</span><br><span class="line">2. 图形化工具：</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://misswanglove.github.io/WangZhi.github.io/WangZhi.github.io/2018/08/09/mysql/day01-初识Mysql与单表/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="王智家园">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/WangZhi.github.io/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="IT小白进阶">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/WangZhi.github.io/2018/08/09/mysql/day01-初识Mysql与单表/" itemprop="url">day01 初识Mysql与单表；</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-08-09T17:50:21+08:00">
                2018-08-09
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/WangZhi.github.io/categories/Mysql/" itemprop="url" rel="index">
                    <span itemprop="name">Mysql</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Mysql的概述"><a href="#Mysql的概述" class="headerlink" title="Mysql的概述"></a>Mysql的概述</h1><p><strong>Mysql的安装和初次使用</strong></p>
<h2 id="Mysql的基本概念"><a href="#Mysql的基本概念" class="headerlink" title="Mysql的基本概念"></a>Mysql的基本概念</h2><ol>
<li>Mysql的英文单词是: database,简称 DB.</li>
<li>什么是数据库? 用于存储和管理数据的仓库</li>
<li>数据库的特点:<ul>
<li>持久化存储数据.其实数据库就是一个文件系统</li>
<li>方便存储和管理数据.</li>
<li>使用统一的方式操作数据库.</li>
</ul>
</li>
<li>常见的数据库软件<ul>
<li>Mysql</li>
<li>Oracle</li>
<li>SQL Server</li>
<li>DB2</li>
</ul>
</li>
</ol>
<h2 id="Mysql数据库软件"><a href="#Mysql数据库软件" class="headerlink" title="Mysql数据库软件"></a>Mysql数据库软件</h2><ol>
<li><p>安装</p>
<ul>
<li>可以自行百度,安装5.7之后会非常简单,5.5之前比较麻烦</li>
</ul>
</li>
<li><p>卸载</p>
<ul>
<li>去mysql的安装目录找到my.ini文件<ul>
<li>复制 datadir=”C:/ProgramData/MySQL/MySQL Server 5.5/Data/“</li>
</ul>
</li>
<li>卸载MySQL(使用工具或者使用电脑的卸载或更改程序进行删除)</li>
<li>删除C:/ProgramData目录下的MySQL文件夹。</li>
</ul>
</li>
<li><p>配置</p>
<ul>
<li><p>Mysql的服务(service),命令行输入services.msc就可以进入windows服务的管理</p>
</li>
<li><p>启动和关闭服务</p>
<ul>
<li>可以在windows服务管理中手动关闭和开启</li>
<li>使用命令输入net start mysql可以打开Mysql服务. 使用net Stop Mysql可以关闭Mysql服务.(如果出现拒绝访问,是权限不够导致,使用管理员权限打开命令行就可以了)</li>
</ul>
</li>
<li><p>Mysql的登录</p>
<ul>
<li>mysql -uroot -ppassword来登录数据库,root是用户名,password指的是密码</li>
<li>mysql -h127.0.0.1 -uroot -ppassword,127.0.0.1指的是ip地址,后面的与第一种方式相同,这个可以用来连接他人的Mysql服务.</li>
<li>mysql –host=ip –user=root –password=password这种方式也可以连接服务</li>
</ul>
<blockquote>
<p>注意端口号如何指定,使用-P3306可以指定端口号,大</p>
</blockquote>
</li>
<li><p>Mysql的退出</p>
<ul>
<li>使用exit(Ctrl+C)进行退出  </li>
<li>使用quit进行退出</li>
</ul>
</li>
<li><p>Mysql的目录结构(默认安装的目录)</p>
<ul>
<li>Mysql的安装目录(C:\Program Files\MySQL\MySQL Server 5.7)</li>
<li>Mysql的数据目录(C:\ProgramData\MySQL\MySQL Server 5.7\Data) <ol>
<li>数据库：文件夹</li>
<li>表：文件</li>
<li>数据：数据 </li>
</ol>
</li>
</ul>
</li>
</ul>
</li>
</ol>
<h2 id="SQL"><a href="#SQL" class="headerlink" title="SQL"></a>SQL</h2><ol>
<li><p>什么是SQL? Structured Query Language：结构化查询语言。其实就是定义了操作所有关系型数据库的规则。每一种数据库操作的方式存在不一样的地方，称为“方言”。</p>
</li>
<li><p>SQL通用语法</p>
<ol>
<li>SQL 语句可以单行或多行书写，以分号结尾。</li>
<li>可使用空格和缩进来增强语句的可读性。</li>
<li>MySQL 数据库的 SQL 语句不区分大小写，关键字建议使用大写。</li>
<li>3 种注释<ul>
<li>单行注释: – 注释内容 或 # 注释内容(mysql 特有) ,注意空格</li>
<li>多行注释: /<em> 注释 </em>/</li>
</ul>
</li>
</ol>
</li>
<li><p>SQL分类</p>
<ol>
<li>DDL(Data Definition Language)数据定义语言,<br>用来定义数据库对象：数据库，表，列等。关键字：create, drop,alter 等</li>
<li>DML(Data Manipulation Language)数据操作语言,<br>用来对数据库中表的数据进行增删改。关键字：insert, delete, update 等</li>
<li>DQL(Data Query Language)数据查询语言,<br>用来查询数据库中表的记录(数据)。关键字：select, where 等</li>
<li>DCL(Data Control Language)数据控制语言(了解),<br>用来定义数据库的访问权限和安全级别，及创建用户。关键字：GRANT， REVOKE 等</li>
</ol>
<p><img src="F:/desktop/Desktop/markdown/Java/mysql/image/SQLType.jpg" alt="SQL分类"></p>
</li>
</ol>
<h2 id="DDL-操作数据库、表"><a href="#DDL-操作数据库、表" class="headerlink" title="DDL : 操作数据库、表"></a>DDL : 操作数据库、表</h2><ol>
<li><p>操作数据库 : CRUD</p>
<ul>
<li>C(Create) : 创建<ul>
<li>创建指定的数据库 : create database db_name;</li>
<li>创建数据库判断 : create database if not exists db_name;</li>
<li>指定字符集 : create database db_name character set 字符编码;</li>
</ul>
</li>
<li>R(Retrieve) : 查询<ul>
<li>查询所有数据库名称 : show databases;</li>
<li>查看某个数据库的字符集(查询创建语句) : show create database db_name;</li>
</ul>
</li>
<li>U(Update) : 修改<ul>
<li>修改字符编码 : alter database db_name character set 字符编码;</li>
</ul>
</li>
<li>D(delete) : 删除<ul>
<li>删除某个数据库 : drop database db_name;</li>
<li>删除前判断 : drop database if exists db_name;</li>
</ul>
</li>
<li>使用数据库 <ul>
<li>使用某个数据库 : use db_name;</li>
<li>查询当前正在使用的数据库名称 : select database();</li>
</ul>
</li>
</ul>
</li>
<li><p>操作表</p>
<ul>
<li><p>C(Create) : 创建</p>
<ul>
<li>语法</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">create	table table_name(</span><br><span class="line">	col1 数据类型1,</span><br><span class="line">	col2 数据类型2,</span><br><span class="line">	........</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<ul>
<li>数据类型</li>
</ul>
</li>
</ul>
</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">		1. int：整数类型</span><br><span class="line">			* age int,</span><br><span class="line">		2. double:小数类型</span><br><span class="line">			* score double(5,2) ——&gt; 5表示小数共5位，2表示小数点后保留两位（最大值为999.99）</span><br><span class="line">		3. date:日期，只包含年月日，yyyy-MM-dd</span><br><span class="line">		4. datetime:日期，包含年月日时分秒	 yyyy-MM-dd HH:mm:ss</span><br><span class="line">		5. timestamp:时间戳类型	包含年月日时分秒	 yyyy-MM-dd HH:mm:ss	</span><br><span class="line">			* 如果将来不给这个字段赋值，或赋值为null，则默认使用当前的系统时间，来自动赋值</span><br><span class="line"></span><br><span class="line">		6. varchar：字符串</span><br><span class="line">			* name varchar(20):姓名最大20个字符</span><br><span class="line">			* zhangsan 8个字符  张三 2个字符 </span><br><span class="line"></span><br><span class="line">* 创建表</span><br><span class="line"></span><br><span class="line">		create table student(</span><br><span class="line">			id int comment &quot;注释&quot;,</span><br><span class="line">			name varchar(32) comment &quot;注释&quot;,</span><br><span class="line">			age int comment &quot;注释&quot;,</span><br><span class="line">			score double(4,1) comment &quot;注释&quot;,</span><br><span class="line">			birthday date comment &quot;注释&quot;,</span><br><span class="line">			insert_time timestamp comment &quot;注释&quot;</span><br><span class="line">		)comment=&quot;表注释&quot;;</span><br><span class="line"></span><br><span class="line">* 复制表(仅赋值结构，不复制数据)：</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">* create table 表名 like 被复制的表名;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">* R(Retrieve) : 查询</span><br></pre></td></tr></table></figure>
<p>​    </p>
<pre><code>* 查询某个数据库所有的表 : show tables;
* 查询表结构 : desc table_name;
* 查询创建表的语句 : show create table table_name;
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">* U(Update) : 修改</span><br><span class="line">	</span><br><span class="line">		* 修改表名 : alter table old_table_name rename to new_table_name;</span><br><span class="line">		* 修改表的字符集 : alter table table_name character set 字符集;</span><br><span class="line">		* 添加一列 : alter table table_name add column_name 数据类型;</span><br><span class="line">		* 添加一列到首行 ： alter table table_name add column_name 数据类型 first;</span><br><span class="line">		* 添加一列到某行之后 ： alter table table_name add column_name 数据类型 after column_name;</span><br><span class="line">		* 修改列的名称 : alter table table_name change old_column_name new_column_name 新的列名;    </span><br><span class="line">		* 修改列的类型 : alter table table_name modify column_name 新的数据类型;</span><br><span class="line">		* 删除列 : alter table table_name drop column_name;</span><br><span class="line">	</span><br><span class="line">* D(delete) : 删除</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">* 删除表 : drop table table_name;</span><br><span class="line">* 删除前判断 : drop table if exists table_name;</span><br></pre></td></tr></table></figure>
<h2 id="DML-：-增删改表中数据"><a href="#DML-：-增删改表中数据" class="headerlink" title="DML ： 增删改表中数据"></a>DML ： 增删改表中数据</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">1. 添加数据：</span><br><span class="line">	* 语法：</span><br><span class="line">		* insert into table_name(列名1,列名2,...列名n) values(值1,值2,...值n);</span><br><span class="line">	* 注意：</span><br><span class="line">		1. 列名和值要一一对应。</span><br><span class="line">		2. 如果表名后，不定义列名，则默认给所有列添加值</span><br><span class="line">			insert into 表名 values(值1,值2,...值n);</span><br><span class="line">		3. 除了数字类型，其他类型需要使用引号(单双都可以)引起来</span><br><span class="line">2. 删除数据：</span><br><span class="line">	* 语法：</span><br><span class="line">		* delete from 表名 [where 条件]</span><br><span class="line">	* 注意：</span><br><span class="line">		1. 如果不加条件，则删除表中所有记录。</span><br><span class="line">		2. 如果要删除所有记录</span><br><span class="line">			1. delete from 表名; -- 不推荐使用。有多少条记录就会执行多少次删除操作</span><br><span class="line">			2. TRUNCATE TABLE 表名; -- 推荐使用，效率更高 先删除表，然后再创建一张一样的表。</span><br><span class="line">3. 修改数据：</span><br><span class="line">	* 语法：</span><br><span class="line">		* update 表名 set 列名1 = 值1, 列名2 = 值2,... [where 条件];</span><br><span class="line"></span><br><span class="line">	* 注意：</span><br><span class="line">		1. 如果不加任何条件，则会将表中所有记录全部修改。</span><br></pre></td></tr></table></figure>
<h2 id="DQL-查询表中的记录"><a href="#DQL-查询表中的记录" class="headerlink" title="DQL : 查询表中的记录"></a>DQL : 查询表中的记录</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">* select * from 表名;</span><br><span class="line"></span><br><span class="line">1. 语法：</span><br><span class="line">	select</span><br><span class="line">		字段列表</span><br><span class="line">	from</span><br><span class="line">		表名列表</span><br><span class="line">	where</span><br><span class="line">		条件列表</span><br><span class="line">	group by</span><br><span class="line">		分组字段</span><br><span class="line">	having</span><br><span class="line">		分组之后的条件</span><br><span class="line">	order by</span><br><span class="line">		排序</span><br><span class="line">	limit</span><br><span class="line">		分页限定</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">2. 基础查询</span><br><span class="line">	1. 多个字段的查询</span><br><span class="line">		select 字段名1，字段名2... from 表名；</span><br><span class="line">		* 注意：</span><br><span class="line">			* 如果查询所有字段，则可以使用*来替代字段列表。</span><br><span class="line">	2. 去除重复：</span><br><span class="line">		* distinct</span><br><span class="line">	3. 计算列</span><br><span class="line">		* 一般可以使用四则运算计算一些列的值。（一般只会进行数值型的计算）</span><br><span class="line">		* ifnull(表达式1,表达式2)：null参与的运算，计算结果都为null</span><br><span class="line">			* 表达式1：哪个字段需要判断是否为null</span><br><span class="line">			* 如果该字段为null后的替换值。</span><br><span class="line">	4. 起别名：</span><br><span class="line">		* as：as也可以省略</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">3. 条件查询</span><br><span class="line">	1. where子句后跟条件</span><br><span class="line">	2. 运算符</span><br><span class="line">		* &gt; 、&lt; 、&lt;= 、&gt;= 、= 、&lt;&gt;</span><br><span class="line">		* BETWEEN...AND  </span><br><span class="line">		* IN( 集合) </span><br><span class="line">		* LIKE：模糊查询</span><br><span class="line">			* 占位符：</span><br><span class="line">				* _:单个任意字符</span><br><span class="line">				* %：多个任意字符</span><br><span class="line">		* IS NULL  </span><br><span class="line">		* and  或 &amp;&amp;</span><br><span class="line">		* or  或 || </span><br><span class="line">		* not  或 !</span><br><span class="line">		</span><br><span class="line">			-- 查询年龄大于20岁</span><br><span class="line"></span><br><span class="line">			SELECT * FROM student WHERE age &gt; 20;</span><br><span class="line">			</span><br><span class="line">			SELECT * FROM student WHERE age &gt;= 20;</span><br><span class="line">			</span><br><span class="line">			-- 查询年龄等于20岁</span><br><span class="line">			SELECT * FROM student WHERE age = 20;</span><br><span class="line">			</span><br><span class="line">			-- 查询年龄不等于20岁</span><br><span class="line">			SELECT * FROM student WHERE age != 20;</span><br><span class="line">			SELECT * FROM student WHERE age &lt;&gt; 20;</span><br><span class="line">			</span><br><span class="line">			-- 查询年龄大于等于20 小于等于30</span><br><span class="line">			</span><br><span class="line">			SELECT * FROM student WHERE age &gt;= 20 &amp;&amp;  age &lt;=30;</span><br><span class="line">			SELECT * FROM student WHERE age &gt;= 20 AND  age &lt;=30;</span><br><span class="line">			SELECT * FROM student WHERE age BETWEEN 20 AND 30;</span><br><span class="line">			</span><br><span class="line">			-- 查询年龄22岁，18岁，25岁的信息</span><br><span class="line">			SELECT * FROM student WHERE age = 22 OR age = 18 OR age = 25</span><br><span class="line">			SELECT * FROM student WHERE age IN (22,18,25);</span><br><span class="line">			</span><br><span class="line">			-- 查询英语成绩为null</span><br><span class="line">			SELECT * FROM student WHERE english = NULL; -- 不对的。null值不能使用 = （!=） 判断</span><br><span class="line">			</span><br><span class="line">			SELECT * FROM student WHERE english IS NULL;</span><br><span class="line">			</span><br><span class="line">			-- 查询英语成绩不为null</span><br><span class="line">			SELECT * FROM student WHERE english  IS NOT NULL;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">-- 查询姓马的有哪些？ like</span><br><span class="line">SELECT * FROM student WHERE NAME LIKE &apos;马%&apos;;</span><br><span class="line">-- 查询姓名第二个字是化的人</span><br><span class="line"></span><br><span class="line">SELECT * FROM student WHERE NAME LIKE &quot;_化%&quot;;</span><br><span class="line"></span><br><span class="line">-- 查询姓名是3个字的人</span><br><span class="line">SELECT * FROM student WHERE NAME LIKE &apos;___&apos;;</span><br><span class="line"></span><br><span class="line">-- 查询姓名中包含德的人</span><br><span class="line">SELECT * FROM student WHERE NAME LIKE &apos;%德%&apos;;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://misswanglove.github.io/WangZhi.github.io/WangZhi.github.io/2018/08/04/成神之路/02-Java中的内存模型/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="王智家园">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/WangZhi.github.io/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="IT小白进阶">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/WangZhi.github.io/2018/08/04/成神之路/02-Java中的内存模型/" itemprop="url">02 Java中的内存模型</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-08-04T20:36:50+08:00">
                2018-08-04
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/WangZhi.github.io/categories/成神之路/" itemprop="url" rel="index">
                    <span itemprop="name">成神之路</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="Java的内存模型"><a href="#Java的内存模型" class="headerlink" title="Java的内存模型"></a>Java的内存模型</h2><h4 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h4><p>Java内存模型的主要目标是定义程序中各个变量的访问规则，即在虚拟机中将变量存储到内存中取出变量（这的变量包括实例字段。静态字段和构成数组对象的元素）这样的底层细节。 </p>
<p>为了获得较好的执行效能。Java内存模型没有限制执行引擎使用处理器的特定寄存器或缓存来和主内存进行交互，也没有限制即时编译器进行调整代码执行顺序这类优化措施。 </p>
<p>Java内存模型规定了所有的变量（前面的变量）都存储在主内存（Main Memory）中，每条线程还有自己的工作内存（Working Memory），线程的工作内存中保存了被该线程使用到的变量的主内存副本拷贝，线程对变量的所有操作（读取，赋值等等）都必须在工作内存中进行，而不能直接读写主内存中的变量，不同的线程之间也无法直接访问对方工作内存中的变量，线程间变量的传递都依靠内存完成。线程、主内存、工作内存的关系如图： <img src="F:\desktop\Desktop\markdown\Java\成神之路\image\memory2.jpg" alt="memory2"></p>
<p>主内存和工作内存之间的交互协议（变量拷贝到工作内存，再从工作内存同步回主内存），Java内存模型定义了8种操作来完成，虚拟机实现必须保证每一个操作都是原子性、不可再分的（double和long例外）。 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">* lock（锁定）:作用于主内存的变量，它把一个变量标识为一条线程独占的状态。</span><br><span class="line">* unlock（解锁）:作用于主内存的变量，它把一个处于锁定状态的变量释放出来，释放后的变量才可以被其他线程锁定。</span><br><span class="line">* read（读取）:作用于主内存的变量，它把一个变量的值从主内存传输到线程的工作内存中，以便随后的load动作使用。</span><br><span class="line">* load（载入）:作用于工作内存的变量，它把read操作从主内存中得到的变量值放入工作内存的变量副本中。</span><br><span class="line">* use（使用）:作用于工作内存的变量，它把工作内存中一个变量的值传递给执行引擎，每当虚拟机遇到一个需要使用到变量的值的字节码指令时将会执行这个操作。</span><br><span class="line">* assign（赋值）:作用于工作内存的变量，它把一个从执行引擎接收到的值赋给工作内存的变量，每当虚拟机遇到一个给变量赋值的字节码指令时执行这个操作。</span><br><span class="line">* store（存储）:作用于工作内存的变量，它把工作内存中一个变量的值传送到主内存中，以便随后的 write操作使用。</span><br><span class="line">* wirte（写入）:作用于主内存的变量，他把store操作从工作内存中得到的变量的值放入主内存的变量中。</span><br></pre></td></tr></table></figure>
<p>变量从主内存到工作内存，必须经过read和load，从 工作内存同步回主内存，需要经过store和write操作，这两个操作必须按顺序执行，但不一定是连续执行。也就是在两个操作之间可以有其他的操作。 在使用上面的8中操作的时候需要满足的规则 ：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">* 不允许read和load、 store和 write操作之一单独出现，即不允许一个变量从主内存读取了但工作内存不接受，或者从工作存发起回写了但主内存不接受的情况出现。</span><br><span class="line">* 不允许一个线程丢弃它的最近的 assign操作，即变量在工作内存中改变了之后必须把该变化同步回主内存。</span><br><span class="line">* 不允许一个线程无原因地（没有发生过任何 assign操作）把数据从线程的工作内存同步回主内存中。</span><br><span class="line">* 一个新的变量只能在主内存中“诞生”，不允许在工作内存中直接使用一个未被初始化（load或 assign）的变量，换句话说，就是对一个变量实施use、 store操作之前必须先执行过了 assign和load操作。</span><br><span class="line">* 一个变量在同一个时刻只允许一条线程其进行1ock操作，但lock操作可以被同一条线程重复执行多次，多次执行lock后，只有执行相同次数的 unlock操作，变量被解锁。</span><br><span class="line">* 如果对一个变量执行lock操作，那将会清空工作内存中此变量的值，在执行引擎使用这个变量前，需要重新执行load或 assign操作初始化变量的值。</span><br><span class="line">* 如果一个变量事先没有被lock操作锁定，那就不允许对它执行unlock操作，也不允许去 unlock一个被其他线程锁定住的变量。</span><br><span class="line">* 对一个变量执行 unlock操作之前，必须先把此变量同步回主内存中（执行stre、wite操作）。</span><br></pre></td></tr></table></figure>
<p>Java内存模型要求的8个操作都具有原子性，但是对于64位的数据类型（long和double），定义了宽松的规定：允许虚拟机将没有被volitale修饰的64位数据的读写操作划分为两次32位的操作来进行，也就是虚拟机实现选择可以不保证64位数据类型的load、store、read和write这四个操作的原子性，这个就是所谓的long和double的非原子性协定。 </p>
<h4 id="内存模型的介绍"><a href="#内存模型的介绍" class="headerlink" title="内存模型的介绍"></a>内存模型的介绍</h4><h6 id="重排序"><a href="#重排序" class="headerlink" title="重排序"></a>重排序</h6><p>如果两个操作访问同一个变量，且这两个操作中有一个为写操作，此时这两个操作之间就存在数据依赖性。编译器和处理器可能会对操作做重排序，但是不会改变存在数据依赖关系的两个操作的执行顺序。遵循as-if-serial语义：即不管程序怎么重排序（编译器和处理器为了提高并行度），（单线程）程序的执行结果不能被改变，但在多线程中，对存在控制依赖的操作重排序，可能会改变程序的执行结果。 </p>
<h6 id="volatile型变量的规则"><a href="#volatile型变量的规则" class="headerlink" title="volatile型变量的规则"></a>volatile型变量的规则</h6><p>volatile是Java虚拟机提供的最轻量级的同步机制。当一个变量被定义为volatile类型后具备两种特性 ：第一是保证此变量对所有线程的可见性，这里的“可见性”是指当一条线程改了这个变量的值，新值对于其他线程来说是可以立即得知的。而普通变量不能做到这一点，普通变量的值在线程间传递均需要通过主内存来完成，例如，线程A修改一个普通变量的值，然后向主内存进行回写。 第二是一条线程B在线程A回写完成了之后再从主内存进行读取操作，新变量值才会对线程B可见。 </p>
<p>使用volatile变量的第一个语义是只保证可见性，有些场景下不适用，这个时候仍然需要通过加锁来保证原子性。不符合的运算场景：一是运算结果并不依赖变量的当前值，或者能够确保只有单一的线程修改变量的值。二是变量不需要与其他的状态变量共同参与不变约束。 </p>
<p> 第二个语义是禁止指令重排序优化，前面的重排序优化说过，编译器和处理器为了提高并行度，会对程序进行重排序，不能保证变量赋值的操作顺序与程序代码中的执行顺序一致。在使用volatile之后，在进行对volatile修饰的变量进行赋值后，会多执行一个lock操作，这个操作相当于一个内存屏障（Memory Barrier或Memory Fence，指重排序时不能把后面的指令重排序到内存屏障之前的位置），只有一个CPU访问是不需要这个内存屏障的，但是多个CPU 访问同一块内存，且其中一个在观测另一个，就需要内存屏障来保证一致性了。 </p>
<p>Java内存模型中对 volatile变量定义的特殊规则。假定T表示一个线程，V和W分别表示两个 volatile型变量，那么在进行read、load、use、 assign store和 write操作时需要满足如下规则: </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">* 只有当线程T对变量V执行的前一个作是load的时候，线程T才能对变量V执行use动作；并且，只有当线程T对变量V执行的后一个动作是use的时候，线程T才能对变量V执行load动作。线程T对变量V的use动作可以认为是和线程T对变量V的load、read动作相关联，必须连续一起出现（这条规则要求在工作内存中，每次使用v前都必须先从主内存刷新最新的值，用于保证能看见其他线程对变量V所做的修改后的值）。</span><br><span class="line">* 只有当线程T对变量V执行的前一个动作是assign的时候，线程T才能对变量V执行store动作；并且，只有当线程T对变量V执行的后一个动作是store的时候，线程T才能对变量V执行assign动作。线程T对变量V的assign动作可以认为是和线程T对变量V的store、 write动作相关联，必须连续一起出现（这条规则要求在工作内存中每次修改V后都必须立刻同步回主内存中，用于保证其他线程可以看到自己对变量v所做的修改）。</span><br><span class="line">* 假定动作A是线程T对变量V实施的use或assign动作，假定动作F是和动作A相关联的load或 store动作，假定动作P是和动作F相应的对变量V的read或 wrte动作；类似的，假定动作B是线程T对变量W实施的use或 assign动作，假定动作是和动作B相关联的load或 store动作，假定动作Q是和动作G相应的对变量WErad或 write a动作。如果A先于B，那么P先于Q（这条规则要求 volatile 修饰的变量不会被指令重排序优化，保证代码的执行顺序与程序的顺序相同）。</span><br></pre></td></tr></table></figure>
<h6 id="原子性"><a href="#原子性" class="headerlink" title="原子性"></a>原子性</h6><p>Java内存模型来直接保证的原子性变量操作包括read、load、assign， use、 store和 wrte，我们大致可以认为基本数据类型的访问读写是具备原子性的（例外就是long和 double的非原子性协定），如果应用场景需要一个更大范围的原子性保证，Java内存模型还提供lock和 unlock操作来满足这种需求，尽管虚拟机未把lock和 unlock操作直接开放给用户使用，但是却提供了更高层次的字节码指令 monitorenter和 monitorexit来隐式地使用这两个操作，这两个字节码指令反映到Java代码中就是同步块— synchronized关键字，因此在synchronized块之间的操作也具备原子性。 </p>
<h6 id="可见性"><a href="#可见性" class="headerlink" title="可见性"></a>可见性</h6><p>可见性是指当一个线程修改了共享变量的值，其他线程能够立即得知这个修改。前面说 volatile变量的时候说过这一点。Java内存模型是通过在变量修改后将新值同步回主内存，在变量读取前从主内存刷新变量值。这种依赖主内存作为传递媒介的方式来实现可见性，无论是普通变量还是 volatile变量都是如此，普通变量与volatile变量的区别是， volatile的特殊规则保证了新值能立即同步到主内存，以及每次使用前立即从主内存刷新。因此，可以说 volatile保证了多线程操作时变量的可见性，而普通变量则不能保证这一点。 </p>
<p>除了 volatile之外，Java还有两个关键字能实现可见性，即 synchronized和 final。同步块的可见性是由“对一个变量执行 unlock作之前，必须先把此变量同步回主内存中（执行store、 write操作）”这条规则获得的，而final关键字的可见性是指:被 final修饰的字段在构造器中一旦初始化完成，并且构造器没有把“this”的引用传递出去（this引用逃逸是一件很危险的事情，其他线程有可能通过这个引用访问到“初始化了一半”的对象），那在其他线程中就能看见 final字段的值。 </p>
<h6 id="有序性"><a href="#有序性" class="headerlink" title="有序性"></a>有序性</h6><p>Java内存模型的有序性在前面说volatile时也说过了，Java程序中天然的有序性可以总结为一句话:如果在本线程内观察，所有的操作都是有序的；如果在一个线程中观察另一个线程，所有的操作都是无序的。前半句是指“线程内表现为串行的语义”（ Within- Thread As-If- Serial Semantics），后半句是指“指令重排序”现象和“工作内存与主内存同步延迟”现象。 </p>
<p>Java语言提供了 volatile和 synchronized 两个关键字来保证线程之间操作的有序性 ，volatile关键字本身就包含了禁止指令重排序的语义，而 synchronized则是由“一个变量在同个时刻只允许一条线程对其进行lock操作”这条规则获得的，这条规则决定了持有同一个锁的两个同步块只能串行地进入。 </p>
<h6 id="先行发生原则"><a href="#先行发生原则" class="headerlink" title="先行发生原则"></a>先行发生原则</h6><p>先行发生是Java内存模型中定义的两项操作之间的偏序关系，如果说操作A先行发生于操作B，其实就是说在发生操作B之前，操作A产生的影响能被操作B观察到，“影响”包括修改了内存中共享变量的值、发送了消息、调用了方法等。 </p>
<p>下面是Java内存模型下一些“天然的”先行发生关系，这些先行发生关系无须任何同步协助就已经存在，可以在编码中直接使用。如果两个操作之间的关系不在此列，并且无法下列规则推导出来的话，它们就没有顺序性保障，虚拟机可以对它们随意地进行重排序 ：</p>
<ul>
<li>程序次序规则（ Program Order Rule）：在一个线程内，按照程序代码顺序，书写在前面的操作先行发生于书写在后面的操作。准确地说，应该是控制流顺序而不是程序代码顺序，因为要考虑分支、循环等结构。</li>
<li>管程锁定规则（ Monitor Lock Rule）:一个 unlock操作先行发生于后面对同一个锁的lock操作。这里必须强调的是同一个锁，而“后面”是指时间上的先后顺序。</li>
<li>volatile变量规则（ Volatile Variable Rul）:对一个 volatile变量的写操作先行发生于后面对这个变量的读操作，这里的“后面”同样是指时间上的先后顺序。</li>
<li>线程启动规则（ Thread Start Rule）: Thread对象的 start（）方法先行发生于此线程的每一个动作。</li>
<li>线程终止规则（ Thread Termination Rul）:线程中的所有操作都先行发生于对此线程的终止检测，我们可以通过 Thread.join()方法结束、 Thread.isAlive()的返回值等手段检测到线程已经终止执行。</li>
<li>线程中断规则（ Thread Interruption Rul）:对线程 interrupt（）方法的调用先行发生于被中断线程的代码检测到中断事件的发生，可以通过 Thread.interrupted()方法检测到是否有中断发生。</li>
<li>对象终结规则（ Finalizer Rule）:一个对象的初始化完成（构造函数执行结束）先行发生于它的 finalize（）方法的开始。</li>
<li>传递性（Transitivity）:如果操作A先行发生于操作B，操作B先行发生于操作C，那就可以得出操作A先行发生于操作C的结论。</li>
</ul>
<p>在Java程序中，时间先后顺序与先行发生原则之间基本没有太大的关系，所以衡量并发安全问题的时候不要受到时间顺序的干扰，一切必须以先行发生原则为准。 </p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://misswanglove.github.io/WangZhi.github.io/WangZhi.github.io/2018/08/04/成神之路/01-Java中的内存结构/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="王智家园">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/WangZhi.github.io/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="IT小白进阶">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/WangZhi.github.io/2018/08/04/成神之路/01-Java中的内存结构/" itemprop="url">01 Java中的内存结构</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-08-04T20:36:24+08:00">
                2018-08-04
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/WangZhi.github.io/categories/成神之路/" itemprop="url" rel="index">
                    <span itemprop="name">成神之路</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="Java中的内存结构"><a href="#Java中的内存结构" class="headerlink" title="Java中的内存结构"></a>Java中的内存结构</h2><h3 id="运行时数据区域的划分："><a href="#运行时数据区域的划分：" class="headerlink" title="运行时数据区域的划分："></a>运行时数据区域的划分：</h3><p><img src="F:\desktop\Desktop\markdown\Java\成神之路\image\memory.jpg" alt="memory"></p>
<h5 id="程序计数器（PC寄存器）"><a href="#程序计数器（PC寄存器）" class="headerlink" title="程序计数器（PC寄存器）"></a>程序计数器（PC寄存器）</h5><p>程序计数器（Program Counter Register）是一块较小的内存空间，可以看做是当前线程所执行的字节码的行号指示器。字节码解释器工作就是通过改变这个计数器的值来选择下一条执行的字节码指令，分支、跳转、循环、异常处理、线程恢复等基础功能都需要依赖计数器来完成。</p>
<p>Java虚拟机的多线程就是通过线程轮流切换并分配处理器执行时间的方式来实现的，在任何一个确定的时刻，一个处理器都只会执行一条线程中的指令。为了线程切换后可以恢复到正确的执行位置，每个线程都需要有一个独立的程序计数器，各个线程之间的计数器互相不影响，独立存储，这类区域也称为“私有线程”的内存。</p>
<p>线程执行Java方法，计数器记录的是正在执行的虚拟机字节码指令的地址；如果执行的是本地方法（Native），计数器为空（undefined）。<strong><em>程序计数器是唯一一个在Java虚拟机规范中没有规定任何OutOfMemoryError情况的区域。</em></strong></p>
<h5 id="Java虚拟机栈（Java方法栈）"><a href="#Java虚拟机栈（Java方法栈）" class="headerlink" title="Java虚拟机栈（Java方法栈）"></a>Java虚拟机栈（Java方法栈）</h5><p>Java虚拟机栈（Java Virtual Machine Stack）也是线程私有的，他的生命周期与线程相同。虚拟机栈描述的是Java方法执行的内存模型：每个方法在执行时都会创建一个栈帧（Stack Frame：方法运行时的基础数据结构）用于存储局部变量表、操作数栈、动态链接、方法出口等信息。每个方法从调用直至执行完成的过程，就对应着一个栈帧在虚拟机栈中从入栈到出栈的一个过程。</p>
<p>局部变量表存放了编译期可知的各种基本数据类型（byte、short、int、long、float、double、char、boolean）、对象引用（reference类型，它不等同与对象本身，可能是一个指向对象起始地址的指针，也可能是指向一个代表对象句柄或其它与此对象相关的位置）和returnAddress类型（指向一条字节码指令的地址）。其中的64位的long和double类型的数据会占用两个局部变量空间，其余数据类型只占用一个。（可以将局部变量表看成一个数组，long和double占用两个数组单元，其余占用一个数组单元，一个数组单元在64位的HotSpot上占用8个字节，32位的HotSpot上占用4个字节，这也意味着在局部变量表，除了long和double，其余的类型所占的空间大小是相同的。但是在堆上存储的字节长度与实际值域相吻合）局部变量表所需的内存空间在编译期间就完成了分配，当进入一个方法时，这个方法需要在帧中分配多大的局部变量空间是完全确定的，在方法运行期间不回改变局部变量表的大小。</p>
<p>两个异常：线程请求的栈深度大于虚拟机所允许的深度，抛出StackOverflowError异常。虚拟机的动态扩展无法申请到足够的内存，会抛出OutOfMemoryError异常。</p>
<h5 id="本地方法栈"><a href="#本地方法栈" class="headerlink" title="本地方法栈"></a>本地方法栈</h5><p>本地方法栈（Native Method Stack）与虚拟机栈所发挥的作用是非常类似的，他们之间的区别不过是虚拟机栈为虚拟机执行java方法（也就是字节码）服务，二本地方法栈为虚拟机使用到的Navicat方法服务 。</p>
<p>本地方法栈也会抛出SatckOverflowError和OutOfMemoryError。 </p>
<h5 id="Java堆"><a href="#Java堆" class="headerlink" title="Java堆"></a>Java堆</h5><p>Java堆（Java Heap）是Java虚拟机所管理的内存中最大的一块。java堆是被所有线程共享的一块内存区域，在虚拟机启动时创建。 此内存区域的唯一目的就是存放对象实例，<strong><em>几乎</em></strong>所有的对象实例都在这分配内存。 Java虚拟机规范中描述：所有的对象实例以及数组都要在堆上分配，但是对着JIT编译器的发挥和逃逸技术逐渐成熟，栈上分配、标量替换优化技术将会导致一些微妙的变化发生，所有的对象都分配在堆上也逐渐变得不是那么绝对。 </p>
<p>Java堆可以处在物理上不连续的内存空间中，只要逻辑上是连续的即可。如果在堆中没有内存完成实例分配，并且堆页无法扩展时，将会抛出OutOfMemoryError异常。 </p>
<p>字符串常量池是在堆中存放和实现的。</p>
<h5 id="方法区"><a href="#方法区" class="headerlink" title="方法区"></a>方法区</h5><p>方法区（Method Area）和Java堆一样，是各个线程共享的内存区域。用于存储已被虚拟机加载的类信息、常量、静态常量。即时编译编译后额代码等数据（字节码相关的文件）。当方法区无法满足内存分配需求时，将抛出OutOfMemoryError异常。 </p>
<p>运行时常量池（Runtime Constant Pool）是方法区的一部分，Class文件中除了有类的版本、字段、方法、接口等描述信息外，还有常量池信息。常量池用于存放编译器生成的各种字面量（文本字符串、八种基本类型的值、被声明为final的常量等）和符号引用（类和方法的全限定名、字段的名称和描述符、方法的名称和描述符），当常量池无法申请到内存时会抛出OutOfMemoryError异常。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://misswanglove.github.io/WangZhi.github.io/WangZhi.github.io/2018/08/02/直面Java/直面Java02-异常汇总/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="王智家园">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/WangZhi.github.io/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="IT小白进阶">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/WangZhi.github.io/2018/08/02/直面Java/直面Java02-异常汇总/" itemprop="url">直面Java02-异常汇总</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-08-02T16:40:51+08:00">
                2018-08-02
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/WangZhi.github.io/categories/直面Java/" itemprop="url" rel="index">
                    <span itemprop="name">直面Java</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="异常相关的总结"><a href="#异常相关的总结" class="headerlink" title="异常相关的总结"></a>异常相关的总结</h2><h3 id="异常的层次结构"><a href="#异常的层次结构" class="headerlink" title="异常的层次结构"></a>异常的层次结构</h3><p><img src="F:\desktop\Desktop\markdown\Java\直面Java\image\throwale.jpg" alt="throwale"></p>
<p>Throwable是Java中最顶级的异常类，继承Object，实现序列化接口，有两个重要的子类：Exception和Error，二者都是Java异常处理的重要子类，各自包含了大量子类。</p>
<h5 id="Exception与Error"><a href="#Exception与Error" class="headerlink" title="Exception与Error"></a>Exception与Error</h5><p>Error是系统级的错误，是Java运行环境内部错误或者硬件错误问题，不能指望依靠程序类处理这样的问题，除了退出程序外，别无选择，是由JVM抛出的。</p>
<p>Exception表示程序需要捕捉、需要处理的异常，是由于程序设计不完善而出现的问题，程序必须处理的问题。</p>
<p>二者都是继承Throwable类，在java中只有Throwable类的实例才能被抛出（throw）或者捕获（catch），他是异常机制的基本组成类型。 </p>
<h5 id="Exception的分类"><a href="#Exception的分类" class="headerlink" title="Exception的分类"></a>Exception的分类</h5><p>Exception分为两类，一类是受检异常（编译期异常），一类是非受检异常（运行时异常）。</p>
<p>受检异常是一个方法在生命过程中抛出受检异常，那么在调用这个方法的时候就要对抛出的受检异常进行处理（继续上抛或者捕获处理），否则无法编译通过，这个是一种规范。这种异常在IO操作中是比较多的，比方说FileNotFoundException，意思是文件可能不存在，不存在的话就会抛出异常。当希望方法的调用者明确处理一些特殊情况的时候，就应该使用受检异常。</p>
<p>非受检异常继承自RuntimeException。这种异常不需要显示的进行捕获，在运行期间一旦出现异常就会中断程序的运行。这种异常一般是代码原因导致，比如说空指针异常、数组越界、by/zero等等，都是可以避免的。</p>
<h5 id="处理受检异常"><a href="#处理受检异常" class="headerlink" title="处理受检异常"></a>处理受检异常</h5><p>使用throw制造异常（应该不算是处理异常）。</p>
<p>使用throws抛出异常。</p>
<p>使用try{}catch(){}finally}{}捕获异常。</p>
<p>总的来说，处理异常只有两种方式，抛出和捕获。</p>
<h5 id="捕获异常之后应该做什么？"><a href="#捕获异常之后应该做什么？" class="headerlink" title="捕获异常之后应该做什么？"></a>捕获异常之后应该做什么？</h5><p>常见的处理方法：记录日志、封装异常重新抛出、忽略、正常返回。最不可取的处理方法是忽略，最好的是伴随日志记录，把异常信息记录下来。</p>
<h5 id="异常处理的关键字"><a href="#异常处理的关键字" class="headerlink" title="异常处理的关键字"></a>异常处理的关键字</h5><p>throws、throw、try、catch、finally是异常处理的关键字。</p>
<p>try是指定一块预防所有异常的程序。catch子句是紧跟try块后面，用来制定你想要捕获的异常类型。finally是为了确保一段代码不管发生什么异常状况都要执行。throw语句是用来明确地抛出一个异常。throws是用来声明一个方法可能抛出的各种异常。</p>
<h5 id="finally语句与return"><a href="#finally语句与return" class="headerlink" title="finally语句与return"></a>finally语句与return</h5><p>finally语句被执行的前提条件是对应try语句块被执行并程序正常运行，正常运行的意思是JVM没有退出或者线程没有被killed、interrupted。</p>
<p>try-catch-finally与return语句的关系。try与catch语句块中有语句：return a + b; 则finally语句块会在a + b之后执行，return 之前执行，也就是<strong>返回前，操作后</strong>执行。</p>
<p>如果finally 中有 return ，那将结果直接返回，在 try 或 catch 中也有 return a，会将 a 的值压栈，再弹出保存到变量表,最终返回新生成的 a 值。 因此在 finally 中操作原来的 a 值对结果没有影响，如果 a 是引用就有影响。 简单说finally中操作的变量不会影响try中的数据，但是不要操作引用数据类型。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">public static void main(String[] args) &#123;</span><br><span class="line">        System.out.println(method()); // 返回的值是0</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static  int method()&#123;</span><br><span class="line">        int a = 10;</span><br><span class="line">        int b = 10;</span><br><span class="line">        try &#123;</span><br><span class="line">            return a + b;</span><br><span class="line">        &#125; catch (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; finally &#123;</span><br><span class="line">            return 0;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h5 id="finally语句一定会执行？"><a href="#finally语句一定会执行？" class="headerlink" title="finally语句一定会执行？"></a>finally语句一定会执行？</h5><p>不一定，前面说过finally会执行的两个前提条件，必须满足才可以执行。比方说在try或者catch块中使用System.exit(0)语句是的JVM中断，这个时候finally语句就不会被执行。</p>
<h5 id="异常链的介绍"><a href="#异常链的介绍" class="headerlink" title="异常链的介绍"></a>异常链的介绍</h5><p>“异常链”是Java中非常流行的异常处理概念，是指在进行一个异常处理时抛出了另外一个异常，由此产生了一个异常链条。该技术大多用于将“ 受检查异常” （ checked exception）封装成为“非受检查异常”（unchecked exception)或者RuntimeException。顺便说一下，如果因为异常你决定抛出一个新的异常，你一定要包含原有的异常，这样，处理程序才可以通过getCause()和initCause()方法来访问异常最终的根源。 </p>
<h5 id="自定义异常"><a href="#自定义异常" class="headerlink" title="自定义异常"></a>自定义异常</h5><p>自定义异常就是开发人员自己定义的异常，一般通过继承Exception的子类的方式实现。  编写自定义异常类实际上是继承一个API标准异常类，用新定义的异常处理信息覆盖原有信息的过程。  这种用法在Web开发中也比较常见，一般可以用来自定义也无异常。如余额不足、重复提交等。这种自定义异常有业务含义，更容易让上层理解和处理。 </p>
<h5 id="try-with-resources"><a href="#try-with-resources" class="headerlink" title="try-with-resources"></a>try-with-resources</h5><p>这个是Java7中新出的，下面比较一下JDK7之前和之后的异常捕获，以IO流来举例。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line">package com.wzlove.demo;</span><br><span class="line"></span><br><span class="line">import java.io.FileReader;</span><br><span class="line">import java.io.FileWriter;</span><br><span class="line">import java.io.IOException;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * 标准的IO格式处理</span><br><span class="line"> *</span><br><span class="line"> * @author WZLOVE</span><br><span class="line"> * @create 2018-07-23 9:54</span><br><span class="line"> */</span><br><span class="line">public class StandardIO &#123;</span><br><span class="line"></span><br><span class="line">    // jdk7之前</span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line"></span><br><span class="line">        // 初始赋值为null</span><br><span class="line">        FileReader fr = null;</span><br><span class="line">        FileWriter fw = null;</span><br><span class="line">          try &#123;</span><br><span class="line">            // 创建字符流对象</span><br><span class="line">            fr = new FileReader(&quot;student.txt&quot;);</span><br><span class="line">            fw = new FileWriter(&quot;student.txt&quot;);</span><br><span class="line"></span><br><span class="line">            // 操作资源(边读编写,耗资源,仅作为示例)</span><br><span class="line">            int len;</span><br><span class="line">            while((len = fr.read()) != -1)&#123;</span><br><span class="line">                fw.write((char) len);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; catch (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; finally &#123;</span><br><span class="line">            try &#123;</span><br><span class="line">                // 判断输入流是否为null</span><br><span class="line">                if(fr != null)&#123;</span><br><span class="line">                    // 关闭资源</span><br><span class="line">                    fr.close();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; catch (IOException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125; finally &#123;</span><br><span class="line"></span><br><span class="line">                try &#123;</span><br><span class="line">                    // 判断输入流是否为null</span><br><span class="line">                    if(fw != null) &#123;</span><br><span class="line">                        // 关闭资源</span><br><span class="line">                        fw.close();</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; catch (IOException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // jdk7之后</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * try(创建IO流对象的代码)&#123;</span><br><span class="line">     *     其他代码</span><br><span class="line">     * &#125;catch(可能出现的异常)&#123;</span><br><span class="line">     *      打印异常信息</span><br><span class="line">     * &#125;</span><br><span class="line">     * 上面的代码会自动调用close方法(也就是IO流对象都实现了Closeable接口(Closeable实现了AutoCloseable接口),</span><br><span class="line">     * 重写close方法).有兴趣的可以查看源码</span><br><span class="line">     */</span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        try (</span><br><span class="line">                // 创建字符流对象</span><br><span class="line">                FileReader fr = new FileReader(&quot;student.txt&quot;);</span><br><span class="line">                FileWriter fw = new FileWriter(&quot;student.txt&quot;);</span><br><span class="line">                )&#123;</span><br><span class="line">                         // 操作资源(边读编写,耗资源,仅作为示例)</span><br><span class="line">                int len;</span><br><span class="line">                while((len = fr.read()) != -1)&#123;</span><br><span class="line">                    fw.write((char) len);</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">        &#125; catch (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>JDK7之后更新的优化还有Multi-Catch Exceptions、Rethrowing Exceptions、Suppressed Exceptions（<a href="http://www.oracle.com/technetwork/articles/java/java7exceptions-486908.html" target="_blank" rel="noopener">http://www.oracle.com/technetwork/articles/java/java7exceptions-486908.html</a>） </p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://misswanglove.github.io/WangZhi.github.io/WangZhi.github.io/2018/08/02/直面Java/直面Java01-AIO-NIO-BIO/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="王智家园">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/WangZhi.github.io/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="IT小白进阶">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/WangZhi.github.io/2018/08/02/直面Java/直面Java01-AIO-NIO-BIO/" itemprop="url">直面Java01-AIO-NIO-BIO</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-08-02T16:39:31+08:00">
                2018-08-02
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/WangZhi.github.io/categories/直面Java/" itemprop="url" rel="index">
                    <span itemprop="name">直面Java</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><strong><em>Hollis知识星球的一些学习笔记,有兴趣的朋友可以微信搜一下</em></strong></p>
<h2 id="什么是NIO"><a href="#什么是NIO" class="headerlink" title="什么是NIO"></a>什么是NIO</h2><p>什么是IO? 它是指计算机与外部世界或者一个程序与计算机的其余部分的之间的接口。它对于任何计算机系统都非常关键，因而所有 I/O 的主体实际上是内置在操作系统中的。单独的程序一般是让系统为它们完成大部分的工作。  在 Java 编程中，直到最近一直使用 流 的方式完成 I/O。所有 I/O 都被视为单个的字节的移动，通过一个称为 Stream 的对象一次移动一个字节。流 I/O 用于与外部世界接触。它也在内部使用，用于将对象转换为字节，然后再转换回对象。 </p>
<p>什么是NIO? NIO 与原来的 I/O 有同样的作用和目的, 他们之间最重要的区别是数据打包和传输的方式。原来的 I/O 以流的方式处理数据，而 NIO 以块的方式处理数据。  面向流 的 I/O 系统一次一个字节地处理数据。一个输入流产生一个字节的数据，一个输出流消费一个字节的数据。为流式数据创建过滤器非常容易。链接几个过滤器，以便每个过滤器只负责单个复杂处理机制的一部分，这样也是相对简单的。不利的一面是，面向流的 I/O 通常相当慢。  一个 面向块 的 I/O 系统以块的形式处理数据。每一个操作都在一步中产生或者消费一个数据块。按块处理数据比按(流式的)字节处理数据要快得多。但是面向块的 I/O 缺少一些面向流的 I/O 所具有的优雅性和简单性。 </p>
<h2 id="什么是AIO"><a href="#什么是AIO" class="headerlink" title="什么是AIO"></a>什么是AIO</h2><p>Java AIO即Async非阻塞，是异步非阻塞的IO。 </p>
<h2 id="什么是BIO"><a href="#什么是BIO" class="headerlink" title="什么是BIO"></a>什么是BIO</h2><p>Java BIO即Block I/O ， 同步并阻塞的IO。  BIO就是传统的java.io包下面的代码实现。 </p>
<h2 id="AIO-BIO-NIO的联系和区别"><a href="#AIO-BIO-NIO的联系和区别" class="headerlink" title="AIO,BIO,NIO的联系和区别"></a>AIO,BIO,NIO的联系和区别</h2><p>BIO （Blocking I/O）：同步阻塞I/O模式，数据的读取写入必须阻塞在一个线程内等待其完成。这里假设一个烧开水的场景，有一排水壶在烧开水，BIO的工作模式就是， 叫一个线程停留在一个水壶那，直到这个水壶烧开，才去处理下一个水壶。但是实际上线程在等待水壶烧开的时间段什么都没有做。 </p>
<p>NIO （New I/O）：同时支持阻塞与非阻塞模式，但这里我们以其同步非阻塞I/O模式来说明，那么什么叫做同步非阻塞？如果还拿烧开水来说，NIO的做法是叫一个线程不断的轮询每个水壶的状态，看看是否有水壶的状态发生了改变，从而进行下一步的操作。   </p>
<p>AIO （ Asynchronous I/O）：异步非阻塞I/O模型。异步非阻塞与同步非阻塞的区别在哪里？异步非阻塞无需一个线程去轮询所有IO操作的状态改变，在相应的状态改变后，系统会通知对应的线程来处理。对应到烧开水中就是，为每个水壶上面装了一个开关，水烧开之后，水壶会自动通知我水烧开了。 </p>
<h2 id="BIO实现文件读写"><a href="#BIO实现文件读写" class="headerlink" title="BIO实现文件读写"></a>BIO实现文件读写</h2><p>直接代码实现:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">package com.wzlove.bio;</span><br><span class="line"></span><br><span class="line">import java.io.Serializable;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * @author 王智</span><br><span class="line"> * @date 2018/7/31</span><br><span class="line"> * @描述 用户实体类</span><br><span class="line"> */</span><br><span class="line">public class User implements Serializable &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    private static final long serialVersionUID = -7521946815608679573L;</span><br><span class="line">    private  String name;</span><br><span class="line"></span><br><span class="line">    private int age;</span><br><span class="line"></span><br><span class="line">    public User() &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public String toString() &#123;</span><br><span class="line">        return &quot;User&#123;&quot; +</span><br><span class="line">                &quot;name=&apos;&quot; + name + &apos;\&apos;&apos; +</span><br><span class="line">                &quot;, age=&quot; + age +</span><br><span class="line">                &apos;&#125;&apos;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public String getName() &#123;</span><br><span class="line">        return name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setName(String name) &#123;</span><br><span class="line">        this.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public int getAge() &#123;</span><br><span class="line">        return age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setAge(int age) &#123;</span><br><span class="line">        this.age = age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public User(String name, int age) &#123;</span><br><span class="line">        this.name = name;</span><br><span class="line">        this.age = age;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">package com.wzlove.bio;</span><br><span class="line"></span><br><span class="line">import java.io.*;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * @author 王智</span><br><span class="line"> * @date 2018/7/31</span><br><span class="line"> * @描述 用来测试BIO</span><br><span class="line"> * BIO : Java BIO即Block I/O ， 同步并阻塞的IO。 测试BIO</span><br><span class="line"> * 其实BIO 也就是我们时常说的序列化流和反序列化流</span><br><span class="line"> */</span><br><span class="line">public class BIODemo &#123;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args)&#123;</span><br><span class="line"></span><br><span class="line">        // 使用输出流进行写入到文件中</span><br><span class="line">        User user = new User(&quot;王智&quot;,23);</span><br><span class="line">        try (ObjectOutputStream oos = new ObjectOutputStream(new FileOutputStream(&quot;test.txt&quot;))) &#123;</span><br><span class="line">            // 写入</span><br><span class="line">            oos.writeObject(user);</span><br><span class="line"></span><br><span class="line">        &#125; catch (FileNotFoundException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; catch (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        // 使用输入流进行读取</span><br><span class="line">        try (ObjectInputStream ois = new ObjectInputStream(new FileInputStream(&quot;test.txt&quot;))) &#123;</span><br><span class="line">            // 进行信息的读取</span><br><span class="line">            User user1 = (User)ois.readObject();</span><br><span class="line">            System.out.println(user1);</span><br><span class="line">        &#125; catch (FileNotFoundException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; catch (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; catch (ClassNotFoundException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>需要注意的是,写入的读取的对象必须实现Serializable接口,生成serialVersionUID,还有无参构造,都要存在.</p>
</blockquote>
<h2 id="NIO实现文件的读写"><a href="#NIO实现文件的读写" class="headerlink" title="NIO实现文件的读写"></a>NIO实现文件的读写</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><span class="line">package com.wzlove.nio;</span><br><span class="line"></span><br><span class="line">import java.io.FileInputStream;</span><br><span class="line">import java.io.FileNotFoundException;</span><br><span class="line">import java.io.FileOutputStream;</span><br><span class="line">import java.io.IOException;</span><br><span class="line">import java.nio.ByteBuffer;</span><br><span class="line">import java.nio.channels.FileChannel;</span><br><span class="line">import java.nio.charset.Charset;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * @author 王智</span><br><span class="line"> * @date 2018/7/31</span><br><span class="line"> * @描述 NIO 以块的方式处理数据</span><br><span class="line"> * 使用的方法有:</span><br><span class="line"> *    ByteBuffer的常用方法:</span><br><span class="line">     *   static ByteBuffer allocate(int capacity) 分配一个新的字节缓冲区。</span><br><span class="line">     *   int capacity() 返回此缓冲区的容量。</span><br><span class="line">     * 	 int position() 返回此缓冲区的位置。</span><br><span class="line">     * 	 int read(ByteBuffer dst) 从该通道读取到给定缓冲区的字节序列。</span><br><span class="line"> *    Charset的常用方法:</span><br><span class="line">     * 	  Charset forName(String charsetName) 返回名为charset的charset对象。</span><br><span class="line">     * 	  ByteBuffer encode(String str) 在此字符集中将字符串编码为字节的便捷方法。</span><br><span class="line"> */</span><br><span class="line">public class NIODemo &#123;</span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        writeNIO();</span><br><span class="line">        System.out.println(&quot;===========================================/&quot;);</span><br><span class="line">        readNIO();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 步骤 :</span><br><span class="line">     *  1.使用输入流创建文件通道</span><br><span class="line">     *  2. 创建字节缓冲区</span><br><span class="line">     *  3. 开始读取内容</span><br><span class="line">     *  4. 将读取的内容转化为字节数组,使用System.out的write方法输出</span><br><span class="line">     */</span><br><span class="line">    public static void readNIO()&#123;</span><br><span class="line">        try (</span><br><span class="line">                // c创建文件通道</span><br><span class="line">                FileChannel fc = new FileInputStream(&quot;nio.txt&quot;).getChannel()</span><br><span class="line">        ) &#123;</span><br><span class="line">            // 创建字节缓冲区(static ByteBuffer allocate(int capacity)分配一个新的字节缓冲区。指定缓冲区的大小  )</span><br><span class="line">            ByteBuffer bb = ByteBuffer.allocate(100);</span><br><span class="line">            // 输出缓冲区的大小</span><br><span class="line">            System.out.println(&quot;输入缓冲区的大小为 : &quot; + bb.capacity());</span><br><span class="line">            // 输出缓冲区的限制大小</span><br><span class="line">            System.out.println(&quot;输入缓冲区的限制大小为 : &quot;  + bb.limit());</span><br><span class="line">            // 输出缓冲区的位置</span><br><span class="line">            System.out.println(&quot;输入缓冲区的位置 : &quot; + bb.position());</span><br><span class="line">            // 进行文件的读取</span><br><span class="line">            int length = -1;</span><br><span class="line">            while((length = fc.read(bb)) != -1)&#123;</span><br><span class="line">                /*</span><br><span class="line">                 * 注意，读取后，将位置置为0，将limit置为容量, 以备下次读入到字节缓冲中，从0开始存储</span><br><span class="line">                 */</span><br><span class="line">                bb.clear();</span><br><span class="line">                byte[] bytes = bb.array();</span><br><span class="line">                System.out.write(bytes,0,length);</span><br><span class="line">                System.out.println();</span><br><span class="line">                // 输出缓冲区的大小</span><br><span class="line">                System.out.println(&quot;输入缓冲区的大小为 : &quot; + bb.capacity());</span><br><span class="line">                // 输出缓冲区的限制大小</span><br><span class="line">                System.out.println(&quot;输入缓冲区的限制大小为 : &quot;  + bb.limit());</span><br><span class="line">                // 输出缓冲区的位置</span><br><span class="line">                System.out.println(&quot;输入缓冲区的位置 : &quot; + bb.position());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; catch (FileNotFoundException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; catch (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 步骤:</span><br><span class="line">     *  1. 使用输出流创建文件通道</span><br><span class="line">     *  2. 创建字节缓冲区</span><br><span class="line">     *  3. 开始进行写入</span><br><span class="line">     */</span><br><span class="line">    public static void writeNIO()&#123;</span><br><span class="line"></span><br><span class="line">        try (</span><br><span class="line">                // 创建FileChannel通道(使用try-with-resouce的形式)</span><br><span class="line">                FileChannel fc = new FileOutputStream(&quot;nio.txt&quot;).getChannel()</span><br><span class="line"></span><br><span class="line">        ) &#123;</span><br><span class="line">            // 按照指定的编码和内容创建字节缓冲区</span><br><span class="line">            ByteBuffer  bb = Charset.forName(&quot;UTF-8&quot;).encode(&quot;你好啊,世界,我爱你,世界&quot;);</span><br><span class="line">            // 输出初始化容量</span><br><span class="line">            System.out.println(&quot;初始化容量 : &quot; + bb.capacity());</span><br><span class="line">            // 输出缓冲区的限制大小</span><br><span class="line">            System.out.println(&quot;缓冲区的限制为 : &quot; + bb.limit());</span><br><span class="line">            int len = 0;</span><br><span class="line">            // 标准的写入文件的代码</span><br><span class="line">            while((len = fc.write(bb)) != 0)&#123;</span><br><span class="line">                /*</span><br><span class="line">                 * 注意，这里不需要clear，将缓冲中的数据写入到通道中后 第二次接着上一次的顺序往下读</span><br><span class="line">                 */</span><br><span class="line">                System.out.println(&quot;写入的长度为 : &quot; + len);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; catch (FileNotFoundException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; catch (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="AIO实现文件的读写-不是特别理解"><a href="#AIO实现文件的读写-不是特别理解" class="headerlink" title="AIO实现文件的读写(不是特别理解)"></a>AIO实现文件的读写(不是特别理解)</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line">public class AioWrite &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) throws Exception &#123;</span><br><span class="line">        // AsynchronousFileChannel用于读取，写入和操作文件的异步通道。当通过调用此类定义的open方法之一来打开文件时，将创建异步文件通道。</span><br><span class="line">        // static AsynchronousFileChannel open(Path file, OpenOption... options) 打开或创建用于读取和/或写入的文件，返回异步文件通道以访问该文件。</span><br><span class="line">        /*</span><br><span class="line">        StandardOpenOption枚举类:</span><br><span class="line">            APPEND 如果文件打开 WRITE访问，则字节将被写入文件的末尾而不是开头。</span><br><span class="line">            CREATE  创建一个新文件（如果不存在）。</span><br><span class="line">            CREATE_NEW 创建一个新的文件，如果该文件已经存在失败。</span><br><span class="line">            DELETE_ON_CLOSE 关闭时删除。</span><br><span class="line">            DSYNC 要求将文件内容的每次更新都与底层存储设备同步写入。</span><br><span class="line">            READ 打开阅读权限。</span><br><span class="line">            SPARSE 稀疏文件</span><br><span class="line">            SYNC 要求将文件内容或元数据的每次更新都同步写入底层存储设备。</span><br><span class="line">            TRUNCATE_EXISTING 如果文件已经存在，并且打开 WRITE访问，则其长度将截断为0。</span><br><span class="line">            WRITE 打开以进行写入。</span><br><span class="line">         */</span><br><span class="line">        AsynchronousFileChannel fileChannel = AsynchronousFileChannel.open(</span><br><span class="line">                Paths.get(&quot;asynchronous.txt&quot;), StandardOpenOption.READ,</span><br><span class="line">                StandardOpenOption.WRITE, StandardOpenOption.CREATE);</span><br><span class="line">        /*</span><br><span class="line">            CompletionHandler 用于消除异步I / O操作结果的处理程序。</span><br><span class="line">            在此包中定义的异步通道允许指定完成处理程序以消耗异步操作的结果。 当I / O操作成功完成时，</span><br><span class="line">            将调用completed方法。 如果I / O操作失败，则调用failed方法。 这些方法的实现应该及时完成，</span><br><span class="line">            以避免将调用线程调度到其他完成处理程序。</span><br><span class="line">        */</span><br><span class="line">        CompletionHandler&lt;Integer, Object&gt; handler = new CompletionHandler&lt;&gt;() &#123;</span><br><span class="line"></span><br><span class="line">            @Override</span><br><span class="line">            public void completed(Integer result, Object attachment) &#123;</span><br><span class="line">                System.out.println(&quot;Attachment: &quot; + attachment + &quot; &quot; + result</span><br><span class="line">                        + &quot; bytes written&quot;);</span><br><span class="line">                System.out.println(&quot;CompletionHandler Thread ID: &quot;</span><br><span class="line">                        + Thread.currentThread().getId());</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            @Override</span><br><span class="line">            public void failed(Throwable e, Object attachment) &#123;</span><br><span class="line">                System.err.println(&quot;Attachment: &quot; + attachment + &quot; failed with:&quot;);</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        System.out.println(&quot;Main Thread ID: &quot; + Thread.currentThread().getId());</span><br><span class="line">        // abstract &lt;A&gt; void write(ByteBuffer src, long position, A attachment, CompletionHandler&lt;Integer,? super A&gt; handler)</span><br><span class="line">        // 从给定的缓冲区向给定的文件位置开始，向该通道写入一个字节序列。</span><br><span class="line">        // static ByteBuffer wrap(byte[] array) 将一个字节数组包装到缓冲区中。</span><br><span class="line">        fileChannel.write(ByteBuffer.wrap(&quot;Sample&quot;.getBytes()), 0, &quot;First Write&quot;,</span><br><span class="line">                handler);</span><br><span class="line">        // 第一次写入Sample,第二次写入也是从索引0位置开始的,所以讲Sam覆盖掉了,变为Box,所以结果为Boxple</span><br><span class="line">        fileChannel.write(ByteBuffer.wrap(&quot;Box&quot;.getBytes()), 0, &quot;Second Write&quot;,</span><br><span class="line">                handler);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">public class AioReader &#123;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) throws Exception &#123;</span><br><span class="line">        // Path可用于在文件系统中定位文件的对象。 它通常表示系统相关的文件路径</span><br><span class="line">        Path file = Paths.get(&quot;asynchronous.txt&quot;);</span><br><span class="line">        // AsynchronousFileChannel是用于读取，写入和操作文件的异步通道。</span><br><span class="line">        AsynchronousFileChannel channel = AsynchronousFileChannel.open(file);</span><br><span class="line">        // 创建字节缓冲区,指定缓冲区的大小</span><br><span class="line">        ByteBuffer buffer = ByteBuffer.allocate(100_000);</span><br><span class="line">        // Future接口,A Future计算的结果。 提供方法来检查计算是否完成，等待其完成，并检索计算结果</span><br><span class="line">        Future&lt;Integer&gt; result = channel.read(buffer, 0);</span><br><span class="line">        // boolean isDone() 返回 true如果任务已完成</span><br><span class="line">        while (!result.isDone()) &#123;</span><br><span class="line">            // 暂时不了解</span><br><span class="line">            ProfitCalculator.calculateTax();</span><br><span class="line">        &#125;</span><br><span class="line">        // V get() 等待计算完成，然后检索其结果。</span><br><span class="line">        Integer bytesRead = result.get();</span><br><span class="line">        // 输出文件内容的字节长度</span><br><span class="line">        System.out.println(&quot;Bytes read [&quot; + bytesRead + &quot;]&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class ProfitCalculator &#123;</span><br><span class="line">    public ProfitCalculator() &#123;</span><br><span class="line">    &#125;</span><br><span class="line">    public static void calculateTax() &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="BIO-NIO-AIO适用的场景"><a href="#BIO-NIO-AIO适用的场景" class="headerlink" title="BIO,NIO,AIO适用的场景"></a>BIO,NIO,AIO适用的场景</h2><p>BIO方式适用于连接数目比较小且固定的架构，这种方式对服务器资源要求比较高，并发局限于应用中，JDK1.4以前的唯一选择，但程序直观简单易理解。</p>
<p>NIO方式适用于连接数目多且连接比较短（轻操作）的架构，比如聊天服务器，并发局限于应用中，编程比较复杂，JDK1.4开始支持。</p>
<p>AIO方式适用于连接数目多且连接比较长（重操作）的架构，比如相册服务器，充分调用OS参与并发操作，编程比较复杂，JDK7开始支持。  </p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://misswanglove.github.io/WangZhi.github.io/WangZhi.github.io/2018/08/01/深入理解Java虚拟机/02-Java的基本数据类型/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="王智家园">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/WangZhi.github.io/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="IT小白进阶">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/WangZhi.github.io/2018/08/01/深入理解Java虚拟机/02-Java的基本数据类型/" itemprop="url">day02_Java的基本数据类型</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-08-01T20:21:29+08:00">
                2018-08-01
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/WangZhi.github.io/categories/深入理解Java虚拟机/" itemprop="url" rel="index">
                    <span itemprop="name">深入理解Java虚拟机</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="基本数据类型的加载和存储"><a href="#基本数据类型的加载和存储" class="headerlink" title="基本数据类型的加载和存储"></a>基本数据类型的加载和存储</h2><h3 id="虚拟机中的Boolean类型"><a href="#虚拟机中的Boolean类型" class="headerlink" title="虚拟机中的Boolean类型"></a>虚拟机中的Boolean类型</h3><p>在Java语言规范中,boolean类型的值只有两种可能,那就是”true”和”false”. 但是这两个符号是不能被Java虚拟机直接使用的.</p>
<p>在Java虚拟机规范中,boolean类型则被映射成int类型. 也就是说,”true”被映射为整数1,”false”被映射为整数0.这个编码规则约束了Java字节码的具体实现.</p>
<h3 id="Java中的基本类型"><a href="#Java中的基本类型" class="headerlink" title="Java中的基本类型"></a>Java中的基本类型</h3><p>Java中的基本类型有8个,上面的boolean类型, 整数类型的byte、short、char、int和 long，以及浮点类型 float 和 double.</p>
<p><img src="./image/java01.jpg" alt="基本数据类型"></p>
<p>java的基本类型都有对应的值域和默认值,如图,从上到下的值域一次增大,后面的值域包含前面的值域,意味着上面的数据类型转换为下面的数据类型不需要进行强制转换。还有注意默认值看起来不一样，实际在内存中都是0。</p>
<p>8个基本数据类型中，只有char和boolean是无符号数。并且boolean类型的取值范围为0或者1，char类型的取值范围为[0,65535]。通常我们认为char类型的值为非负数。</p>
<p>Java 的浮点类型采用 IEEE 754 浮点数格式。以 float 为例，浮点类型通常有两个 0，+0.0F 以及 -0.0F。前者在 Java 里是 0，后者是符号位为 1、其他位均为 0 的浮点数，在内存中等同于十六进制整数 0x8000000（即 -0.0F 可通过Float.intBitsToFloat(0x8000000) 求得）。尽管它们的内存</p>
<p>数值不同，但是在 Java 中 +0.0F == -0.0F 会返回真。</p>
<p>有了+0.0F和-0.0F后，那么浮点数中的正无穷和负无穷就可以定义了。正无穷就是任意正浮点数（不包括 +0.0F）除以 +0.0F 得到的值，而负无穷是任意正浮点数除以 -0.0F得到的值。在 Java 中，正无穷和负无穷是有确切的值，在内存中分别等同于十六进制整数0x7F800000 和 0xFF800000。</p>
<p>那超出范围的数字呢？ 对应的是NaN（Not-a-Number）,0x7FC00000为标准的NaN，其他的称之为不标准的NaN。并且NaN有一个特性，任何数 ！= NaN 永远返回true。</p>
<h3 id="Java基本类型的大小"><a href="#Java基本类型的大小" class="headerlink" title="Java基本类型的大小"></a>Java基本类型的大小</h3><h5 id="存储时的大小"><a href="#存储时的大小" class="headerlink" title="存储时的大小"></a>存储时的大小</h5><p>Java 虚拟机每调用一个 Java 方法，便会创建一个栈帧。暂时理解为解释器使用的解释栈帧。包括两个组成部分，局部变量区和字节码操作数栈。</p>
<p>在Java虚拟机规范中，局部变量区等价于一个数组，并且可以用正整数索引。除了long、double值需要用两个数组单元来存储之外，其他的基本类型以及引用类型的值均占用一个数组单元。</p>
<p>也就是说，boolean、byte、char、short这四种类型，在栈上占用的空间和int是一样的，和引用类型也是一样的。也就是32位的HotSpot上，栈上占用4个字节；64位的HotSpot上，占用8个字节。</p>
<p>当然，这种情况仅存在于局部变量，而并不会出现在存储于堆上的字段和数组元素伤。对于byte、char以及short这三种类型的字段或者数组单元，他们在堆上占用的空间分别为一字节、两字节以及两字节，与值域是相吻合的。</p>
<p>因此，当我们将一个 int 类型的值，存储到这些类型的字段或数组时，相当于做了一次隐式的掩码操作。举例来说，当我们把0xFFFFFFFF（-1）存储到一个声明为 char 类型的字段里时，由</p>
<p>于该字段仅占两字节，所以高两位的字节便会被截取掉，最终存入“\uFFFF”。</p>
<p>boolean 字段和 boolean 数组则比较特殊。在 HotSpot 中，boolean 字段占用一字节，而boolean 数组则直接用 byte 数组来实现。为了保证堆中的 boolean 值是合法的，HotSpot 在存储时显式地进行掩码操作，也就是说，只取最后一位的值存入boolean 字段或数组中。</p>
<h5 id="加载时的大小"><a href="#加载时的大小" class="headerlink" title="加载时的大小"></a>加载时的大小</h5><p>Java 虚拟机的算数运算几乎全部依赖于操作数栈。也就是说，我们需要将堆中的 boolean、byte、char 以及 short 加载到操作数栈上，而后将栈上的值当成 int 类型来运算。</p>
<p>对于 boolean、char 这两个无符号类型来说，加载伴随着零扩展。举个例子，char 的大小为两个字节。在加载时 char 的值会被复制到 int 类型的低二字节，而高二字节则会用 0 来填充。</p>
<p>对于 byte、short 这两个类型来说，加载伴随着符号扩展。举个例子，short 的大小为两个字节。在加载时 short 的值同样会被复制到 int 类型的低二字节。如果该 short 值为非负数，即最</p>
<p>高位为 0，那么该 int 类型的值的高二字节会用 0 来填充，否则用 1 来填充。</p>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>其中，boolean 类型在 Java 虚拟机中被映射为整数类型：“true”被映射为 1，而“false”被映射为 0。Java 代码中的逻辑运算以及条件跳转，都是用整数相关的字节码来实现的。</p>
<p>除 boolean 类型之外，Java 还有另外 7 个基本类型。它们拥有不同的值域，但默认值在内存中均为 0。这些基本类型之中，浮点类型比较特殊。基于它的运算或比较，需要考虑+0.0F、-0.0F 以及 NaN 的情况。</p>
<p>除 long 和 double 外，其他基本类型与引用类型在解释执行的方法栈帧中占用的大小是一致的，但它们在堆中占用的大小确不同。在将 boolean、byte、char 以及 short 的值存入字段或</p>
<p>者数组单元时，Java 虚拟机会进行掩码操作。在读取时，Java 虚拟机则会将其扩展为 int 类型。</p>
<h5 id="我的理解"><a href="#我的理解" class="headerlink" title="我的理解"></a>我的理解</h5><p>从这个中，可以学到，8种基本数据的大小，还有虚拟机对于基本数据类型的规范是什么，堆上和解释执行的方法栈帧上的byte、short、char、boolean类型的存储的大小是不一样的，加载（读取）的时候，会进行掩码的操作。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/WangZhi.github.io/page/2/">2</a><a class="page-number" href="/WangZhi.github.io/page/3/">3</a><a class="extend next" rel="next" href="/WangZhi.github.io/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">王智家园</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/WangZhi.github.io/archives">
              
                  <span class="site-state-item-count">27</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/WangZhi.github.io/categories/index.html">
                  <span class="site-state-item-count">4</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">39</span>
                  <span class="site-state-item-name">标签</span>
                
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">王智家园</span>

  
</div>

<div class="powered-by">
<i class="fa fa-user-md"></i><span id="busuanzi_container_site_uv">
  本站访客数:<span id="busuanzi_value_site_uv"></span>
</span>
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/WangZhi.github.io/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/WangZhi.github.io/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/WangZhi.github.io/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/WangZhi.github.io/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/WangZhi.github.io/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/WangZhi.github.io/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/WangZhi.github.io/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/WangZhi.github.io/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/WangZhi.github.io/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
<script type="text/javascript" src="/js/src/love.js"></script>
